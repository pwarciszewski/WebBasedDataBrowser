(this.webpackJsonpwbdb=this.webpackJsonpwbdb||[]).push([[0],{256:function(e,t,a){e.exports=a(619)},268:function(e,t,a){},269:function(e,t,a){},270:function(e,t,a){},271:function(e,t,a){},272:function(e,t,a){},283:function(e,t,a){},284:function(e,t,a){},287:function(e,t,a){},288:function(e,t,a){},289:function(e,t,a){},290:function(e,t,a){},291:function(e,t,a){},292:function(e,t,a){},293:function(e,t,a){},294:function(e,t,a){},295:function(e,t,a){},296:function(e,t,a){},297:function(e,t,a){},602:function(e,t,a){},605:function(e,t){},607:function(e,t){},617:function(e,t,a){},618:function(e,t,a){},619:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(65),i=a(4),o=a(66),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_DATATREE":return t.new_data_tree;default:return e}},l=a(14),s=a(6),f=a(20),d=a(22),m=a.n(d),v=function(e,t){var a=e.findIndex((function(e){return!0===e.focussed})),n=[];-1!==a&&(n=m()(e,Object(f.a)({},a,{focussed:{$set:!1}})));var r,c=Object(s.a)(t);try{var i=function(){var e=r.value,t=e.data.iter_token,a=n.findIndex((function(e){return e.iter_token===t}));-1===a?n=[{iter_token:t,focussed:!1,data_frames:[e]}].concat(Object(l.a)(n)):n[a].data_frames=[e].concat(Object(l.a)(n[a].data_frames))};for(c.s();!(r=c.n()).done;)i()}catch(o){c.e(o)}finally{c.f()}return n[0].focussed=!0,n},p=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1?arguments[1]:void 0,n=[];switch(a.type){case"SET_ACTIVE_FRAMES":return(n=a.active_frames_list.reverse()).forEach((function(e){return e.focussed=!1})),n[0].focussed=!0,n;case"CLEAR_FRAMES":return[];case"ADD_ACTIVE_FRAMES":return v(t,a.new_frames);case"REMOVE_ONE_OF_ACTIVE_FRAMES":var r,c=t.indexOf(a.frame_to_remove);r=t.length>1&c+1<t.length?c+1:c+1===t.length&0!==c?c-1:c;var i=[];return i=t[c].focussed?m()(t,Object(f.a)({},r,{focussed:{$set:!0}})):t,[].concat(Object(l.a)(i.slice(0,c)),Object(l.a)(i.slice(c+1)));case"SET_FOCUS":var o=t.indexOf(a.frame),u=t.findIndex((function(e){return!0===e.focussed})),d=m()(t,(e={},Object(f.a)(e,u,{focussed:{$set:!1}}),Object(f.a)(e,o,{focussed:{$set:!0}}),e));return d;case"FOCUS_NEXT":var p=function(e){var a,n=t.indexOf(e),r=n<t.length-1?n+1:n;return 0!==t.length?m()(t,(a={},Object(f.a)(a,n,{focussed:{$set:!1}}),Object(f.a)(a,r,{focussed:{$set:!0}}),a)):t};return p(a.frame);case"FOCUS_PREVIOUS":var _=function(e){var a,n=t.indexOf(e),r=n>0?n-1:n;return 0!==t.length?m()(t,(a={},Object(f.a)(a,n,{focussed:{$set:!1}}),Object(f.a)(a,r,{focussed:{$set:!0}}),a)):t};return _(a.frame);case"UPDATE_ACTIVE_FRAMES":var h=function(e){var a,n=t,r=Object(s.a)(e);try{var c=function(){var e=a.value,r=t.findIndex((function(t){return t.iter_token===e.data.iter_token})),c=t[r].data_frames.findIndex((function(t){return t.id===e.id}));n=m()(n,Object(f.a)({},r,{data_frames:Object(f.a)({},c,{data:{$set:e.data}})}))};for(r.s();!(a=r.n()).done;)c()}catch(i){r.e(i)}finally{r.f()}return n};return h(a.frames_to_update);default:return t}},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["Welcome to WBDB UI!"],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_LOG":var a=function(t){return e.length<200?[].concat(Object(l.a)(e),[t]):[].concat(Object(l.a)(e.slice(1,200)),[t])};return a(t.text);default:return e}},h=0,E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_WINDOW":return h+=1,[].concat(Object(l.a)(e),[{id:h,window_type:t.window_type}]);case"REMOVE_WINDOW":return[].concat(Object(l.a)(e.slice(0,e.findIndex((function(e){return e.id===t.id})))),Object(l.a)(e.slice(e.findIndex((function(e){return e.id===t.id}))+1)));default:return e}},y=0,b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_IMAGE_ROI":return y+=1,[].concat(Object(l.a)(e),[{roi_id:y,roi_type:t.roi_type,roi_data:t.roi_data,display_roi:t.display_roi}]);case"UPDATE_IMAGE_ROI_XY":var a=function(){var a=e.findIndex((function(e){return e.roi_id===t.roi_id}));return m()(e,Object(f.a)({},a,{roi_data:{x:{$set:t.roi_new_x},y:{$set:t.roi_new_y}}}))};return a();case"UPDATE_IMAGE_ROI_WH":var n=function(){var a=e.findIndex((function(e){return e.roi_id===t.roi_id}));return m()(e,Object(f.a)({},a,{roi_data:{width:{$set:t.roi_new_w},height:{$set:t.roi_new_h}}}))};return n();case"SET_ROI_DISPLAY":var r=function(){var a=e.findIndex((function(e){return e.roi_id===t.roi_id}));return m()(e,Object(f.a)({},a,{display_roi:{$set:t.display_roi}}))};return r();case"REMOVE_ROI":return[].concat(Object(l.a)(e.slice(0,e.findIndex((function(e){return e.roi_id===t.roi_id})))),Object(l.a)(e.slice(e.findIndex((function(e){return e.roi_id===t.roi_id}))+1)));default:return e}},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_OPERATIONS":var a=[],n=function(n){e.some((function(e){return e.operation_name===n}))||a.push({operation_name:n,operation_properties:t.available_ops_list[n]})};for(var r in t.available_ops_list)n(r);return[].concat(Object(l.a)(e),a);case"UPDATE_OPERATION":var c=e.findIndex((function(e){return e.operation_name===t.updated_operation.operation_name})),i=m()(e,Object(f.a)({},c,{operation_properties:{$set:t.updated_operation.operation_properties}}));return i;default:return e}},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NEW_ROUTINE":return[t.new_routine];case"ADD_OPERATION":var a=function(t){var a=e[0];return a.push(t),a};return[a(t.operation)];case"REMOVE_OPERATION":var n=function(t){return[].concat(Object(l.a)(e[0].slice(0,t)),Object(l.a)(e[0].slice(t+1)))};return[n(t.index)];case"CHANGE_OPERATION":var r=function(t,a,n){var r=e[0];return r[t].params[a]=n,r};return[r(t.index,t.param,t.value)];default:return e}},I=Object(o.b)({datatree:u,activeframes:p,loglist:_,openwindows:E,imagerois:b,availableops:O,serverroutine:g}),j=a(150),N=a.n(j),S=a(250),w="/DataBrowse";function k(){return C.apply(this,arguments)}function C(){return(C=Object(S.a)(N.a.mark((function e(){var t,a,n,r=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:"",a=r.length>1&&void 0!==r[1]?r[1]:{},e.next=4,fetch(t,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(a)});case 4:return n=e.sent,e.abrupt("return",n.json());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){fetch(w+"/getnewestid/").then((function(e){return e.json()})).then((function(t){e(t)})).catch((function(e){return console.log(e)}))}function A(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];k(w+"/fetchdata/",{selected:t,group_by_iter:a}).then((function(t){e(t)})).catch((function(e){return console.log(e)}))}var T=function(e){return{type:"SET_FOCUS",frame:e}},x=function(e){return{type:"ADD_LOG",text:e}},D=function(e){return{type:"ADD_WINDOW",window_type:e}},M=function(e,t,a){return{type:"ADD_IMAGE_ROI",roi_type:e,roi_data:t,display_roi:a}},L=function(e,t,a){return{type:"UPDATE_IMAGE_ROI_XY",roi_id:e,roi_new_x:t,roi_new_y:a}},P=function(e){return{type:"SET_NEW_ROUTINE",new_routine:e}},V=function(e,t,a){return{type:"CHANGE_OPERATION",index:e,param:t,value:a}},F=a(251),U=a.n(F);a(267),a(268);var B=function(){var e=Object(i.c)((function(e){return e.datatree})),t=Object(i.b)();return r.a.createElement("div",{className:"DataTree"},r.a.createElement(U.a,{data:e,onChange:function(a,n){A((function(e){t({type:"SET_ACTIVE_FRAMES",active_frames_list:e})}),function e(t){var a=[];for(var n in t)t[n].hasOwnProperty("value")?a.push(Number(t[n].value)):a.push.apply(a,Object(l.a)(e(t[n].children)));return a}(function(e,t){var a=[];for(var n in e){var r=e[n]._id.split("-");r.shift();var c=(r=r.map((function(e){return Number(e)}))).pop(),i=t;for(var o in r)i=i[r[o]].children;i=i[c],a.push(i)}return a}(n,e)),!0)},onFocus:function(){var e;e=function(e){t({type:"LOAD_DATATREE",new_data_tree:e})},fetch(w+"/getdatatree/").then((function(e){return e.json()})).then((function(t){e(t)})).catch((function(e){return console.log(e)}))},keepTreeOnSearch:!0,showPartiallySelected:!0,texts:{placeholder:"Select frames..."}}))},W=a(8),G=(a(269),function(){var e=Object(i.b)(),t=Object(n.useState)(0),a=Object(W.a)(t,2),c=a[0],o=a[1],u=Object(n.useState)(!1),l=Object(W.a)(u,2),s=l[0],f=l[1],d=Object(n.useState)(0),m=Object(W.a)(d,2),v=m[0],p=m[1];return Object(n.useEffect)((function(){var t=setInterval((function(){!function(t,a,n){if(t&&(R((function(e){p(e)})),n!==a)){e(x("Detected new frame(s)!"));for(var r=[],c=n+1;c<=a;c++)r.push(c);o(a),A((function(t){e({type:"ADD_ACTIVE_FRAMES",new_frames:t})}),[a])}}(s,v,c)}),500);return function(){return clearInterval(t)}}),[s,v,c]),r.a.createElement("div",{className:"NewDataWatcher",active:s.toString(),onClick:function(){return s||(e(x("Watching for new frames...")),R((function(e){p(e),o(e)}))),void f(!s)}},r.a.createElement("div",{className:"displaytext"},"Loading new frames: ",String(s)))}),$=(a(270),function(){var e=Object(i.b)();return r.a.createElement("div",{className:"AddWindowSelection"},r.a.createElement("div",{className:"dropdown"},"Add new window ","\u25bc"),r.a.createElement("div",{className:"dropdown-content"},r.a.createElement("div",{className:"dropdown-selection",onClick:function(){return e(D("SelectedFrames"))}},"Selected frames"),r.a.createElement("div",{className:"dropdown-selection",onClick:function(){return e(D("LogList"))}},"Application logs"),r.a.createElement("div",{className:"dropdown-selection",onClick:function(){return e(D("AttributesList"))}},"Attributes list"),r.a.createElement("div",{className:"dropdown-selection",onClick:function(){return e(D("ImageDisplayer"))}},"Image displayer"),r.a.createElement("div",{className:"dropdown-selection",onClick:function(){return e(D("ROIs"))}},"Display ROIs"),r.a.createElement("div",{className:"dropdown-selection",onClick:function(){return e(D("RoiManager"))}},"ROIs manager"),r.a.createElement("div",{className:"dropdown-selection",onClick:function(){return e(D("ChartDisplayer"))}},"Graph displayer"),r.a.createElement("div",{className:"dropdown-selection",onClick:function(){return e(D("CSVDisplayer"))}},"CSV displayer")))}),J=(a(271),function(){var e=Object(i.c)((function(e){return e.activeframes})),t=e.reduce((function(e,t){return function(e,t){var a=[],n=t.data_frames;if(void 0!==n){var r,c=Object(s.a)(n);try{for(c.s();!(r=c.n()).done;){var i=r.value;a.push(i.id)}}catch(o){c.e(o)}finally{c.f()}}return e.concat(a)}(e,t)}),[]);return r.a.createElement("div",{className:"FileDownloader"},r.a.createElement("form",{action:w+"/download/",method:"post",id:"formdownload",onSubmit:function(e){return function(e){window.confirm("Zipping files might take a while. Click OK to proceed")||e.preventDefault()}(e)}},r.a.createElement("input",{id:"container_for_ids",type:"hidden",name:"ids",value:[JSON.stringify(t)]}),r.a.createElement("button",{type:"submit"},"Download")))}),z=(a(272),a(151)),H=a.n(z),q=a(53),X=(a(282),function(e){var t=e.variable,a=e.value,n=e.handleValueChange;return r.a.createElement("div",{className:"Variable"},r.a.createElement("label",null,t+": "),r.a.createElement("input",{type:"text",defaultValue:a,onChange:function(e){return n(e.target.value)}}),r.a.createElement("br",null))}),Y=function(e){var t=e.index,a=e.param_name,n=e.value,c=Object(i.b)(),o=Object(i.c)((function(e){return e.imagerois}));return r.a.createElement("div",{className:"VariableDesigner"},r.a.createElement("label",null,a+": "),r.a.createElement("input",{defaultValue:n,type:"text",onChange:function(e){return c(V(t,a,e.target.value))}}),r.a.createElement("select",{onChange:function(e){return function(e){"INIT"!==e&&c(V(t,a,e))}(e.target.value)}},r.a.createElement("option",{value:"INIT"}," Select ROI"),function(e){var t,a=[],n=Object(s.a)(e);try{for(n.s();!(t=n.n()).done;){var c=t.value;for(var i in c.roi_data)a.push(r.a.createElement("option",{value:c.roi_data[i],key:"ID "+c.roi_id+"; "+i},"ID "+c.roi_id+"; "+i))}}catch(o){n.e(o)}finally{n.f()}return a}(o)))},Z=function(e){var t=e.operation,a=e.index,n=Object(i.b)();return r.a.createElement("div",{className:"Operation"},r.a.createElement("div",null,t.operation," ",r.a.createElement("button",{className:"close",onClick:function(){return n(function(e){return{type:"REMOVE_OPERATION",index:e}}(a))}},"\u2715")),r.a.createElement("div",null,function(){var e=[];for(var n in t.params)e.push(r.a.createElement(Y,{key:n,index:a,param_name:n,value:t.params[n]}));return e}()))},K=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.serverroutine}))[0],a=Object(i.c)((function(e){return e.availableops})),c=Object(n.useState)("INIT"),o=Object(W.a)(c,2),u=o[0],l=o[1];return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("select",{value:u,onChange:function(e){return l(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select operation"),function(e){var t,a,n=[],c=Object(s.a)(e);try{for(c.s();!(t=c.n()).done;){var i=t.value;n.push(r.a.createElement("option",{value:JSON.stringify((a=i,{operation:a.operation_name,params:a.operation_properties.variables})),key:i.operation_name},i.operation_name))}}catch(o){c.e(o)}finally{c.f()}return n}(a)),r.a.createElement("button",{onClick:function(){var t;"INIT"!==(t=u)&&e(function(e){return{type:"ADD_OPERATION",operation:e}}(JSON.parse(t)))}},"Add operation")),r.a.createElement("div",null,function(e){var t,a=[],n=Object(s.a)(e.entries());try{for(n.s();!(t=n.n()).done;){var c=Object(W.a)(t.value,2),i=c[0],o=c[1];a.push(r.a.createElement(Z,{operation:o,index:i,key:i}))}}catch(u){n.e(u)}finally{n.f()}return a}(t)),r.a.createElement("div",{className:"UploadNewRoutineSpace"},r.a.createElement("button",{onClick:function(){return a=function(t){return e(x(t))},void k(w+"/setRoutine/",{new_routine:t}).then((function(){return a("Routine updated")})).catch((function(e){return console.log(e)}));var a}},"Upload new routine")))};H.a.setAppElement("#root");var Q={content:{top:"40%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",fontFamily:"Arial, Helvetica, sans-serif",background:"#f4f4f4"},overlay:{backgroundColor:"rgba(0,0,0,0.4)"}},ee=function(e){return r.a.createElement("option",{key:e,value:e},e)},te=function(e,t,a){return"FOCUSSED"===t?function(e,t){var a=e.find((function(e){return!0===e.focussed}));if(void 0===a)return[];var n,r=[],c=Object(s.a)(a.data_frames);try{for(c.s();!(n=c.n()).done;){var i=n.value;("ALL"===t||i.data.data_source===t)&&r.push(i.id)}}catch(o){c.e(o)}finally{c.f()}return r}(e,a):function(e,t,a){var n,r=[],c=Object(s.a)(e);try{for(c.s();!(n=c.n()).done;){var i,o=n.value,u=Object(s.a)(o.data_frames);try{for(u.s();!(i=u.n()).done;){var l=i.value;"ALL"===a?l.data.sequence_name===t&&r.push(l.id):l.data.sequence_name===t&&l.data.data_source===a&&r.push(l.id)}}catch(f){u.e(f)}finally{u.f()}}}catch(f){c.e(f)}finally{c.f()}return r}(e,t,a)},ae=function(){var e=Object(i.b)(),t=Object(n.useState)(!1),a=Object(W.a)(t,2),c=a[0],o=a[1],u=function(){var t;t=function(t){return e(P(t))},fetch(w+"/fetchRoutine/").then((function(e){return e.json()})).then((function(e){return t(e)})).catch((function(e){return console.log(e)})),function(e){fetch(w+"/fetchOps/").then((function(e){return e.json()})).then((function(t){e(t)})).catch((function(e){return console.log(e)}))}((function(t){return e({type:"INITIALIZE_OPERATIONS",available_ops_list:t})})),o(!0)},l=Object(i.c)((function(e){return e.availableops})),f=Object(i.c)((function(e){return e.activeframes})),d=function(e){var t,a=[],n=Object(s.a)(e);try{for(n.s();!(t=n.n()).done;){var r,c=t.value,i=Object(s.a)(c.data_frames);try{for(i.s();!(r=i.n()).done;){var o=r.value;a.includes(o.data.sequence_name)||a.push(o.data.sequence_name)}}catch(u){i.e(u)}finally{i.f()}}}catch(u){n.e(u)}finally{n.f()}return a}(f),m=function(e){var t,a=[],n=Object(s.a)(e);try{for(n.s();!(t=n.n()).done;){var r,c=t.value,i=Object(s.a)(c.data_frames);try{for(i.s();!(r=i.n()).done;){var o=r.value.data.data_source;a.includes(o)||a.push(o)}}catch(u){i.e(u)}finally{i.f()}}}catch(u){n.e(u)}finally{n.f()}return a}(f),v=Object(n.useState)("FOCUSSED"),p=Object(W.a)(v,2),_=p[0],h=p[1],E=Object(n.useState)("ALL"),y=Object(W.a)(E,2),b=y[0],O=y[1],g=Object(n.useState)({}),I=Object(W.a)(g,2),j=I[0],N=I[1],S=Object(n.useState)("INIT"),C=Object(W.a)(S,2),R=C[0],T=C[1],D=Object(i.c)((function(e){return e.imagerois})),M=Object(n.useState)("INIT"),L=Object(W.a)(M,2),V=L[0],F=L[1],U=function(e,t,a){var n=e;n.operation_properties.variables[t]=a,N(n)};return r.a.createElement("div",{className:"OperationsMenuButton"},r.a.createElement("button",{onClick:function(){return u()}},"Operations menu"),r.a.createElement(H.a,{isOpen:c,style:Q,shouldCloseOnOverlayClick:!0,onRequestClose:function(){return o(!1)}},r.a.createElement(q.d,null,r.a.createElement(q.b,null,r.a.createElement(q.a,null,"Dispatch operation"),r.a.createElement(q.a,null,"Routines designer")),r.a.createElement(q.c,null,r.a.createElement("div",null,r.a.createElement("h2",null,"Operations Menu"),r.a.createElement("h3",null,"Selected frames"),r.a.createElement("select",{value:b,onChange:function(e){return O(e.target.value)}},r.a.createElement("option",{key:"ALL",value:"ALL"},"All devices"),m.map((function(e){return ee(e)}))),r.a.createElement("select",{value:_,onChange:function(e){return h(e.target.value)}},r.a.createElement("option",{key:"FOCUSSED",value:"FOCUSSED"},"Currently focussed frame"),d.map((function(e){return ee(e)}))),r.a.createElement("h3",null,"Operation options"),r.a.createElement("select",{value:R,onChange:function(e){return t=e.target.value,T(t),void N(l.find((function(e){return e.operation_name===t})));var t}},r.a.createElement("option",{key:"INIT",value:"INIT"}," Select operation"),l.map((function(e){return function(e){var t=e.operation_name;return r.a.createElement("option",{key:t,value:t},t)}(e)})))," ",r.a.createElement("br",null),"bind to ROI:",r.a.createElement("select",{value:V,onChange:function(e){return F(e.target.value)}},r.a.createElement("option",{value:"INIT"}," Nothing "),D.map((function(e){return r.a.createElement("option",{key:e.roi_id,value:e.roi_id},"ID: ",e.roi_id)}))),function(e,t){var a=[],n=void 0===t?{}:t;try{var c=function(t){n.hasOwnProperty("roi_data")&&n.roi_data.hasOwnProperty(t)||a.push(r.a.createElement(X,{variable:t,value:e.operation_properties.variables[t],handleValueChange:function(e){return U(j,t,e)},key:t}))};for(var i in e.operation_properties.variables)c(i)}catch(o){return r.a.createElement("h4",null,"Select operation")}return a}(j,D.find((function(e){return e.roi_id==V})))),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){"INIT"!==R&&function(e,t,a,n,r){n("Starting "+a+"..."),k(w+"/do/",{selected:e,parameters:t,operation:a}).then((function(e){return n(e)})).then((function(){return A(r,e)})).catch((function(e){return console.log(e)}))}(te(f,_,b),function(e,t){var a=e.hasOwnProperty("operation_properties")?e:{operation_properties:{variables:{}}},n=void 0===t?{roi_data:{}}:t,r={};for(var c in a.operation_properties.variables)n.roi_data.hasOwnProperty(c)?r[c]=n.roi_data[c]:r[c]=a.operation_properties.variables[c];return r}(j,D.find((function(e){return e.roi_id==V}))),R,(function(t){return e(x(t))}),(function(t){return e({type:"UPDATE_ACTIVE_FRAMES",frames_to_update:t})}))}},"Dispatch!"))),r.a.createElement(q.c,null,r.a.createElement(K,null)))))},ne=(a(283),function(){return r.a.createElement("div",{className:"MenuBar"},r.a.createElement(B,null),r.a.createElement(J,null),r.a.createElement(G,null),r.a.createElement(ae,null),r.a.createElement($,null))}),re=(a(284),a(68)),ce=(a(287),function(e){var t=Object(i.b)();return r.a.createElement(re.a,{bounds:".WorkSpace",className:"WindowWrapper",dragHandleClassName:"header",resizeGrid:[20,20],dragGrid:[20,20],default:{x:0,y:0,width:e.default_width,height:e.default_height},lockAspectRatio:e.lock_aspect_ratio,enableResizing:e.resizable},r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"header-name"},e.window_name),r.a.createElement("div",{className:"header-close",onClick:function(){return t({type:"REMOVE_WINDOW",id:e.id})}},"\u2715")),e.children)}),ie=(a(288),function(e,t,a){var n="";try{var r=e.data_frames.findIndex((function(e){return e.data.data_source==t}));n=""+(n=e.data_frames[r].data.results[a].value)}catch(c){n="/static/DataBrowse/img/no_img.png"}return n}),oe=function(e){var t=e.iter_frame,a=e.img_source_device,n=e.img_source_result,c=Object(i.b)();return r.a.createElement("div",{className:"DataTile",focussed:t.focussed.toString()},r.a.createElement("div",{className:"TileContent",onClick:function(){return c(T(t))}},r.a.createElement("img",{className:"TileImage",src:ie(t,a,n),height:70,width:70}),t.data_frames[0].data.sequence_name,r.a.createElement("div",{className:"FileList"},"Files' sources in this iteration:",t.data_frames.map((function(e){return r.a.createElement("div",{key:e.id}," ",e.data.data_source," ")})))),r.a.createElement("div",{className:"close",onClick:function(){return c({type:"REMOVE_ONE_OF_ACTIVE_FRAMES",frame_to_remove:t})}},"\u2715"))},ue=(a(289),function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.activeframes})).find((function(e){return!0===e.focussed}));return r.a.createElement("div",{className:"NavigButtons"},r.a.createElement("button",{className:"NavigButton",onClick:function(){return e({type:"FOCUS_PREVIOUS",frame:t})}}," ","\u25c0"," "),r.a.createElement("button",{className:"NavigButton",onClick:function(){return e({type:"CLEAR_FRAMES"})}}," Clear "),r.a.createElement("button",{className:"NavigButton",onClick:function(){return e({type:"FOCUS_NEXT",frame:t})}}," ","\u25b6"," "))}),le=(a(290),function(){var e=Object(i.c)((function(e){return e.activeframes})),t=e.find((function(e){return!0===e.focussed})),a=Object(n.useRef)(null),c=Object(n.useRef)(null);Object(n.useEffect)((function(){return function(e,t){if(null!==e.current){var a=e.current.offsetTop-t.current.scrollTop;(a>t.current.clientHeight||a<0)&&t.current.scrollTo(0,e.current.offsetTop-100)}}(a,c)}));var o=Object(n.useState)("INIT"),u=Object(W.a)(o,2),l=u[0],f=u[1],d=Object(n.useState)("INIT"),m=Object(W.a)(d,2),v=m[0],p=m[1],_=function(e){var t,a=[],n=Object(s.a)(e);try{for(n.s();!(t=n.n()).done;){var r,c=t.value,i=Object(s.a)(c.data_frames);try{for(i.s();!(r=i.n()).done;){var o=r.value.data.data_source;a.includes(o)||a.push(o)}}catch(u){i.e(u)}finally{i.f()}}}catch(u){n.e(u)}finally{n.f()}return a}(e),h=function(e,t){var a,n=[],r=Object(s.a)(t);try{for(r.s();!(a=r.n()).done;){var c,i=a.value,o=Object(s.a)(i.data_frames);try{for(o.s();!(c=o.n()).done;){var u=c.value;for(var l in u.data.results)"IMG"===u.data.results[l].type&&u.data.data_source===e&&(n.includes(l)||n.push(l))}}catch(f){o.e(f)}finally{o.f()}}}catch(f){r.e(f)}finally{r.f()}return n}(l,e);return r.a.createElement("div",{className:"SelectedFramesList"},r.a.createElement(ue,null),r.a.createElement("div",{className:"SourceSelection"},r.a.createElement("select",{value:l,onChange:function(e){return f(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select device"),_.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)}))),r.a.createElement("select",{value:v,onChange:function(e){return p(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select result"),h.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)})))),r.a.createElement("div",{className:"TilesSpace",ref:c},e.map((function(e){return e.iter_token===t.iter_token?r.a.createElement("div",{ref:a,key:e.iter_token},r.a.createElement(oe,{key:e.iter_token,iter_frame:e,img_source_device:l,img_source_result:v})):r.a.createElement("div",{key:e.iter_token},r.a.createElement(oe,{key:e.iter_token,iter_frame:e,img_source_device:l,img_source_result:v}))}))))}),se=(a(291),function(){var e=Object(i.c)((function(e){return e.loglist})),t=r.a.createRef();return Object(n.useEffect)((function(){t.current.scrollTop=t.current.scrollHeight})),r.a.createElement("div",{className:"Console",ref:t},r.a.createElement("ul",null,e.map((function(e,t){return r.a.createElement("li",{key:e+t},e)}))))}),fe=function(e){return void 0!==e?r.a.createElement("td",null,e):""},de=function(e){var t=e.props;return r.a.createElement("tr",null,fe(t.name),fe(t.type),fe(t.value))},me=(a(292),function(){var e=Object(i.c)((function(e){return e.activeframes})).find((function(e){return!0===e.focussed})),t=function(e){var t=[];if(void 0!==e){var a,n=Object(s.a)(e.data_frames);try{for(n.s();!(a=n.n()).done;){var r=a.value.data.data_source;t.includes(r)||t.push(r)}}catch(c){n.e(c)}finally{n.f()}}return t}(e),a=Object(n.useState)("PROPS"),c=Object(W.a)(a,2),o=c[0],u=c[1],l=Object(n.useState)("INIT"),f=Object(W.a)(l,2),d=f[0],m=f[1];return r.a.createElement("div",{className:"FrameAttributesList"},r.a.createElement("label",null,"Display:",r.a.createElement("select",{value:d,onChange:function(e){return m(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select device"),t.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)}))),r.a.createElement("select",{value:o,onChange:function(e){return u(e.target.value)}},r.a.createElement("option",{value:"PROPS"},"Properties"),r.a.createElement("option",{value:"RES"},"Results"))),r.a.createElement("div",{className:"tableSpace"},r.a.createElement("table",null,r.a.createElement("tbody",null,"RES"===o?r.a.createElement("tr",null,r.a.createElement("th",null,"Result Name"),r.a.createElement("th",null,"Result Type"),r.a.createElement("th",null,"Result Value")):r.a.createElement("tr",null,r.a.createElement("th",null,"Property Name"),r.a.createElement("th",null,"Property Value")),function(e,t,a){if(void 0===e||"INIT"===a)return[];var n=[],r=e.data_frames.findIndex((function(e){return e.data.data_source===a}));if(-1===r)return[];var c="PROPS"===t?e.data_frames[r].data.properties:e.data_frames[r].data.results;for(var i in c)"RES"===t?n.push({name:i,type:c[i].type,value:c[i].value}):n.push({name:i,value:c[i]});return n}(e,o,d).map((function(e,t){return r.a.createElement(de,{key:t,props:e})}))))))}),ve=function(e,t,a){var n="";try{var r=e.data_frames.findIndex((function(e){return e.data.data_source===a}));n=""+(n=e.data_frames[r].data.results[t].value)}catch(c){n="/static/DataBrowse/img/no_img.png"}return n},pe=function(e){return r.a.createElement("img",{className:"SelectedImage",src:ve(e.iter_frame,e.result,e.device)})},_e=(a(293),function(){var e=Object(i.c)((function(e){return e.activeframes})).find((function(e){return!0===e.focussed})),t=Object(n.useState)("INIT"),a=Object(W.a)(t,2),c=a[0],o=a[1],u=Object(n.useState)("INIT"),l=Object(W.a)(u,2),f=l[0],d=l[1],m=function(e){var t=[];if(void 0!==e){var a,n=Object(s.a)(e.data_frames);try{for(n.s();!(a=n.n()).done;){var r=a.value.data.data_source;t.includes(r)||t.push(r)}}catch(c){n.e(c)}finally{n.f()}}return t}(e),v=function(e,t){var a=[];if(void 0!==e){var n=e.data_frames.findIndex((function(e){return e.data.data_source===t}));if(-1===n)return["None"];for(var r in e.data_frames[n].data.results)"IMG"===e.data_frames[n].data.results[r].type&&a.push(r)}else a.push("None");return a}(e,c);return r.a.createElement("div",{className:"ImageDisplayer"},r.a.createElement("div",{className:"ResultSelect"},r.a.createElement("select",{value:c,onChange:function(e){return o(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select device"),m.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)}))),r.a.createElement("select",{value:f,onChange:function(e){return d(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select result to show"),v.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)})))),r.a.createElement(pe,{iter_frame:e,result:f,device:c}))}),he=function(e,t,a){var n="";try{var r=e.data_frames.findIndex((function(e){return e.data.data_source===a}));n=""+(n=e.data_frames[r].data.results[t].value)}catch(c){n="/static/DataBrowse/img/no_img.png"}return n},Ee=function(e){return r.a.createElement("div",{className:"SelectedImageRoi"},r.a.createElement("img",{className:"ImageRoi",src:he(e.iter_frame,e.result,e.device),onLoad:function(t){return e.imgOnload(t.target.naturalWidth,t.target.naturalHeight)}}),e.children)},ye=(a(294),function(e){var t=Object(i.c)((function(e){return e.activeframes})).find((function(e){return!0===e.focussed})),a=Object(n.useState)("INIT"),c=Object(W.a)(a,2),o=c[0],u=c[1],l=Object(n.useState)("INIT"),f=Object(W.a)(l,2),d=f[0],m=f[1],v=function(e){var t=[];if(void 0!==e){var a,n=Object(s.a)(e.data_frames);try{for(n.s();!(a=n.n()).done;){var r=a.value.data.data_source;t.includes(r)||t.push(r)}}catch(c){n.e(c)}finally{n.f()}}return t}(t),p=function(e,t){var a=[];if(void 0!==e){var n=e.data_frames.findIndex((function(e){return e.data.data_source===t}));if(-1===n)return["None"];for(var r in e.data_frames[n].data.results)"IMG"===e.data_frames[n].data.results[r].type&&a.push(r)}else a.push("None");return a}(t,o);return r.a.createElement("div",{className:"ImageDisplayerRoi"},r.a.createElement("div",{className:"ResultSelect"},r.a.createElement("select",{value:o,onChange:function(e){return u(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select device"),v.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)}))),r.a.createElement("select",{value:d,onChange:function(e){return m(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select result to show"),p.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)})))),r.a.createElement(Ee,{iter_frame:t,result:d,device:o,imgOnload:e.imgOnload},e.children))}),be=function(e){var t=e.placement,a=e.id,n=e.onDrag,c=e.onResize;return r.a.createElement(re.a,{position:{x:t.x,y:t.y},size:{width:t.width,height:t.height},title:a,bounds:".SelectedImageRoi",onDragStop:function(e,t){n(a,t.x,t.y)},onResizeStop:function(e,t,n,r,i){c(a,i.x,i.y,n.offsetWidth,n.offsetHeight)}},r.a.createElement("div",{className:"Rectangle"}))},Oe=function(e){var t=e.placement,a=e.id,n=e.onDrag;return r.a.createElement(re.a,{position:{x:t.x,y:t.y},size:{width:20,height:20},title:a,enableResizing:!1,bounds:".SelectedImageRoi",onDragStop:function(e,t){n(a,t.x,t.y)}},r.a.createElement("div",{className:"Point"},"\u2715"))},ge=(a(295),function(){var e=Object(n.useState)(0),t=Object(W.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(0),u=Object(W.a)(o,2),l=(u[0],u[1]),s=Object(i.b)(),f=function(e){var t=a/600;return t>1?{x:Math.round(e.x/t),y:Math.round(e.y/t),width:Math.round(e.width/t),height:Math.round(e.height/t)}:e},d=function(e){var t=a/600;return t>1?{x:Math.round(e.x/t-12),y:Math.round(e.y/t-12)}:{x:Math.round(e.x-12),y:Math.round(e.y-12)}},m=function(e){var t=a/600;return t>1?Math.round(e*t):e},v=function(e){var t=a/600;return t>1?Math.round(e*t+12*t):e+12},p=function(e,t,a){s(L(e,m(t),m(a)))},_=function(e,t,a){s(L(e,v(t),v(a)))},h=function(e,t,a,n,r){var c,i,o;s(L(e,m(t),m(a))),s((c=e,i=m(n),o=m(r),{type:"UPDATE_IMAGE_ROI_WH",roi_id:c,roi_new_w:i,roi_new_h:o}))},E=Object(i.c)((function(e){return e.imagerois})).filter((function(e){return!0===e.display_roi}));return r.a.createElement("div",{className:"SelectRoi"},r.a.createElement(ye,{imgOnload:function(e,t){c(e),l(t)}},E.map((function(e){return function(e){switch(e.roi_type){case"RECTANGLE":return r.a.createElement(be,{key:e.roi_id,id:e.roi_id,placement:f(e.roi_data),onDrag:p,onResize:h});case"POINT":return r.a.createElement(Oe,{key:e.roi_id,id:e.roi_id,placement:d(e.roi_data),onDrag:_})}}(e)}))))}),Ie=(a(296),function(e){var t=e.roi,a=Object(i.b)();return r.a.createElement("div",{className:"RoiTile"},"ROI ID: ",t.roi_id," ",r.a.createElement("input",{type:"checkbox",checked:t.display_roi,onClick:function(){return a((e=t.roi_id,n=!t.display_roi,{type:"SET_ROI_DISPLAY",roi_id:e,display_roi:n}));var e,n}}),r.a.createElement("div",{className:"close",onClick:function(){return a({type:"REMOVE_ROI",roi_id:t.roi_id})}},"\u2715"),r.a.createElement("br",null),"type: ",t.roi_type," ",r.a.createElement("br",null),JSON.stringify(t.roi_data,null,1))}),je=(a(297),{x:0,y:0,width:200,height:200}),Ne={x:200,y:200},Se=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.imagerois}));return r.a.createElement("div",{className:"RoiManager"},r.a.createElement("div",{className:"RoiButtons"},r.a.createElement("button",{className:"AddButton",onClick:function(){return e(M("RECTANGLE",je,!0))}},"Add rectangle"),r.a.createElement("button",{className:"AddButton",onClick:function(){return e(M("POINT",Ne,!0))}},"Add point")),r.a.createElement("div",{className:"RoisList"},t.map((function(e){return r.a.createElement(Ie,{key:e.roi_id,roi:e})}))))},we=a(105),ke=a.n(we),Ce=(a(602),["#111d5e","#c70039","#f37121","#ffbd69","#086972","#01a9b4","#87dfd6","#fbfd8a","#184d47","#96bb7c"]),Re=function e(t,a){if(!a||!t)return!1;if(t.length!=a.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]instanceof Array&&a[n]instanceof Array){if(e(!t[n],a[n]))return!1}else if(t[n]!=a[n])return!1;return!0},Ae=function(e){return e[0]+" result: "+e[1]},Te=function(e){return e[0]+" property: "+e[1]},xe=function(e,t){var a={};if("INIT"!==t){var n=JSON.parse(t),r=n[0],c=n[1];switch(n[2]){case"property":var i,o=Object(s.a)(e);try{for(o.s();!(i=o.n()).done;){var u,l=i.value,f=Object(s.a)(l.data_frames);try{for(f.s();!(u=f.n()).done;){var d=u.value;try{d.data.data_source===r&&(a[d.id]=[d.data.properties[c],d.data.iter_token])}catch(y){}}}catch(b){f.e(b)}finally{f.f()}}}catch(b){o.e(b)}finally{o.f()}case"result":var m,v=Object(s.a)(e);try{for(v.s();!(m=v.n()).done;){var p,_=m.value,h=Object(s.a)(_.data_frames);try{for(h.s();!(p=h.n()).done;){var E=p.value;try{E.data.data_source===r&&(a[E.id]=[E.data.results[c].value,E.data.iter_token])}catch(y){}}}catch(b){h.e(b)}finally{h.f()}}}catch(b){v.e(b)}finally{v.f()}}}return a},De=function(e){var t,a=function(e){var t,a=[],n=Object(s.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;a.includes(r.data_frames[0].data.sequence_name)||a.push(r.data_frames[0].data.sequence_name)}}catch(c){n.e(c)}finally{n.f()}return a}(e),n={},r=Object(s.a)(a.entries());try{for(r.s();!(t=r.n()).done;){var c=Object(W.a)(t.value,2),i=c[0];n[c[1]]=Ce[i%Ce.length]}}catch(p){r.e(p)}finally{r.f()}var o,u={},l=Object(s.a)(e);try{for(l.s();!(o=l.n()).done;){var f,d=o.value,m=Object(s.a)(d.data_frames);try{for(m.s();!(f=m.n()).done;){var v=f.value;u[v.id]=n[v.data.sequence_name]}}catch(p){m.e(p)}finally{m.f()}}}catch(p){l.e(p)}finally{l.f()}return u},Me=function(e,t,a,n,r){var c="",i="";if("INIT"!==t){var o=JSON.parse(t);c=o[0]+": "+o[1]}if("INIT"!==a){var u=JSON.parse(a);i=u[0]+": "+u[1]}var l,f={backgroundColor:"#f4f4f4",tooltip:{trigger:"axis",showContent:!1,axisPointer:{type:"cross"}},xAxis:{min:n.min_x,max:n.max_x,name:c,nameLocation:"center",type:"value",splitLine:{lineStyle:{type:"dashed"}}},yAxis:{min:n.min_y,max:n.max_y,name:i,type:"value",splitLine:{lineStyle:{type:"dashed"}}},series:[]},d=Object(s.a)(e);try{for(d.s();!(l=d.n()).done;){var m=l.value;f.series.push({name:m.iter_token,data:[m.data],type:"scatter",color:r[m.id],emphasis:{label:{show:!0,position:"left",color:"black",fontSize:16}}})}}catch(v){d.e(v)}finally{d.f()}return f},Le=function(e,t){var a,n=[],r=Object(s.a)(t);try{for(r.s();!(a=r.n()).done;){var c=a.value;n.push(c.data)}}catch(i){r.e(i)}finally{r.f()}!function(e,t){for(var a=function(e){for(var t="",a=0;a<e.length;a++){var n=null===e[a]?"":e[a].toString();e[a]instanceof Date&&(n=e[a].toLocaleString());var r=n.replace(/"/g,'""');r.search(/("|,|\n)/g)>=0&&(r='"'+r+'"'),a>0&&(t+=","),t+=r}return t+"\n"},n="",r=0;r<t.length;r++)n+=a(t[r]);var c=new Blob([n],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(c,e);else{var i=document.createElement("a");if(void 0!==i.download){var o=URL.createObjectURL(c);i.setAttribute("href",o),i.setAttribute("download",e),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}}}(e,n)},Pe=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.activeframes})),a=De(t),c=Object(n.useState)("INIT"),o=Object(W.a)(c,2),u=o[0],l=o[1],f=Object(n.useState)("INIT"),d=Object(W.a)(f,2),m=d[0],v=d[1],p=function(e){var t,a={},n=[],r=[],c=Object(s.a)(e);try{for(c.s();!(t=c.n()).done;){var i,o=t.value,u=Object(s.a)(o.data_frames);try{for(u.s();!(i=u.n()).done;){var l=i.value,f=function(e){var t=[l.data.data_source,e,"property"];n.some((function(e){return Re(e,t)}))||n.push(t)};for(var d in l.data.properties)f(d);var m=function(e){var t=[l.data.data_source,e,"result"];r.some((function(e){return Re(e,t)}))||"NUM"!==l.data.results[e].type||r.push(t)};for(var v in l.data.results)m(v)}}catch(p){u.e(p)}finally{u.f()}}}catch(p){c.e(p)}finally{c.f()}return a.properties=n,a.results=r,a}(t),_=function(e,t){var a=[];for(var n in e)if(t.hasOwnProperty(n)){var r={};r.id=n,r.data=[Number(e[n][0]),Number(t[n][0])],r.iter_token=e[n][1],a.push(r)}return a}(xe(t,u),xe(t,m)),h=function(e){var t=e.map((function(e){return e.data[0]})),a=e.map((function(e){return e.data[1]})),n=Math.min.apply(null,t),r=Math.max.apply(null,t),c=Math.min.apply(null,a),i=Math.max.apply(null,a),o=r-n,u=i-c;return{min_x:n-.05*o,max_x:r+.05*o,min_y:c-.05*u,max_y:i+.05*u}}(_),E={click:function(a){return e(T(t.find((function(e){return e.iter_token===a.seriesName}))))}};return r.a.createElement("div",{className:"ChartDisplayer"},r.a.createElement("div",{className:"ChartSelector"},"Select X:",r.a.createElement("select",{value:u,onChange:function(e){return l(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select values source"),p.properties.map((function(e,t){return r.a.createElement("option",{key:"p"+String(t),value:JSON.stringify(e)},Te(e))})),p.results.map((function(e,t){return r.a.createElement("option",{key:"r"+String(t),value:JSON.stringify(e)},Ae(e))}))),"Select Y:",r.a.createElement("select",{value:m,onChange:function(e){return v(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select values source"),p.properties.map((function(e,t){return r.a.createElement("option",{key:"p"+String(t),value:JSON.stringify(e)},Te(e))})),p.results.map((function(e,t){return r.a.createElement("option",{key:"r"+String(t),value:JSON.stringify(e)},Ae(e))}))),r.a.createElement("button",{onClick:function(){return Le("result.csv",_)}},"Download")),r.a.createElement(ke.a,{option:Me(_,u,m,h,a),onEvents:E,style:{height:"calc(100% - 30px)",width:"100%"}}))},Ve=a(254),Fe=(a(617),function(e){var t,a={backgroundColor:"#f4f4f4",xAxis:{type:"value"},yAxis:{type:"value"},toolbox:{feature:{dataZoom:{yAxisIndex:"none",title:{zoom:"Zoom",back:"Back"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image"}}},tooltip:{trigger:"axis",axisPointer:{type:"cross",animation:!1,label:{backgroundColor:"#505765"}}},series:[]},n=Object(s.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;a.series.push({type:"line",showSymbol:!1,data:r})}}catch(c){n.e(c)}finally{n.f()}return a}),Ue=function(e,t){var a,n=[],r=Object(s.a)(t);try{for(r.s();!(a=r.n()).done;){var c,i=a.value,o=Object(s.a)(i);try{for(o.s();!(c=o.n()).done;){var u=c.value;n.push(u)}}catch(l){o.e(l)}finally{o.f()}}}catch(l){r.e(l)}finally{r.f()}!function(e,t){for(var a=function(e){for(var t="",a=0;a<e.length;a++){var n=null===e[a]?"":e[a].toString();e[a]instanceof Date&&(n=e[a].toLocaleString());var r=n.replace(/"/g,'""');r.search(/("|,|\n)/g)>=0&&(r='"'+r+'"'),a>0&&(t+=","),t+=r}return t+"\n"},n="",r=0;r<t.length;r++)n+=a(t[r]);var c=new Blob([n],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(c,e);else{var i=document.createElement("a");if(void 0!==i.download){var o=URL.createObjectURL(c);i.setAttribute("href",o),i.setAttribute("download",e),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}}}(e,n)},Be=function(){var e=Object(i.c)((function(e){return e.activeframes})),t=Object(n.useState)(!0),a=Object(W.a)(t,2),c=a[0],o=a[1],u=Object(n.useState)("INIT"),f=Object(W.a)(u,2),d=f[0],m=f[1],v=Object(n.useState)("INIT"),p=Object(W.a)(v,2),_=p[0],h=p[1],E=function(e){var t,a=[],n=Object(s.a)(e);try{for(n.s();!(t=n.n()).done;){var r,c=t.value,i=Object(s.a)(c.data_frames);try{for(i.s();!(r=i.n()).done;){var o=r.value.data.data_source;a.includes(o)||a.push(o)}}catch(u){i.e(u)}finally{i.f()}}}catch(u){n.e(u)}finally{n.f()}return a}(e),y=function(e,t){var a,n=[],r=Object(s.a)(t);try{for(r.s();!(a=r.n()).done;){var c,i=a.value,o=Object(s.a)(i.data_frames);try{for(o.s();!(c=o.n()).done;){var u=c.value;for(var l in u.data.results)"CSV"===u.data.results[l].type&&u.data.data_source===e&&(n.includes(l)||n.push(l))}}catch(f){o.e(f)}finally{o.f()}}}catch(f){r.e(f)}finally{r.f()}return n}(d,e),b=function(e,t,a,n){var r=[];if("INIT"!==e&&"INIT"!==t&&a.length>0)if(n){var c="";try{c=a.find((function(e){return!0===e.focussed})).data_frames.find((function(t){return t.data.data_source===e})).data.results[t].value}catch(f){c=void 0}void 0!==c&&r.push(c)}else{var i,o=Object(s.a)(a);try{for(o.s();!(i=o.n()).done;){var u=i.value,l="";try{l=u.data_frames.find((function(t){return t.data.data_source===e})).data.results[t].value}catch(d){l=void 0}void 0!==l&&r.push(l)}}catch(m){o.e(m)}finally{o.f()}}return r}(d,_,e,c),O=Object(n.useState)([]),g=Object(W.a)(O,2),I=g[0],j=g[1];return Object(n.useEffect)((function(){return function e(t,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(t.length>0){var r=t[0];t.shift(),Object(Ve.a)(""+r,{download:!0,complete:function(r){e(t,a,[].concat(Object(l.a)(n),[r.data]))}})}else n.length>0&&a(n)}(b,j)}),[d,_,e,c]),r.a.createElement("div",{className:"CSVDisplayer"},r.a.createElement("div",{className:"CSVSelector"},r.a.createElement("select",{value:d,onChange:function(e){return m(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select device"),E.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)}))),r.a.createElement("select",{value:_,onChange:function(e){return h(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select result to show"),y.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)}))),"Display only focussed:",r.a.createElement("input",{type:"checkbox",defaultChecked:c,onChange:function(){return o(!c)}}),r.a.createElement("button",{onClick:function(){return Ue("result.csv",I)}},"Download")),r.a.createElement(ke.a,{option:Fe(I),notMerge:!0,style:{height:"calc(100% - 30px)",width:"100%"}}))},We=function(e){return r.a.createElement(ce,{id:e.id,window_name:"Application logs",default_width:400,default_height:120},r.a.createElement(se,null))},Ge=function(e){return r.a.createElement(ce,{id:e.id,window_name:"Selected frames",default_width:250,default_height:520},r.a.createElement(le,null))},$e=function(e){return r.a.createElement(ce,{id:e.id,window_name:"ROIs manager",default_width:340,default_height:320},r.a.createElement(Se,null))},Je=function(e){return r.a.createElement(ce,{id:e.id,window_name:"Data frame atributes",default_width:600,default_height:280},r.a.createElement(me,null))},ze=function(e){return r.a.createElement(ce,{id:e.id,window_name:"Image displayer",default_width:400,default_height:452,lock_aspect_ratio:!0},r.a.createElement(_e,null))},He=function(e){return r.a.createElement(ce,{id:e.id,window_name:"ROIs",default_width:600,default_height:600,resizable:!1},r.a.createElement(ge,null))},qe=function(e){return r.a.createElement(ce,{id:e.id,window_name:"Chart",default_width:840,default_height:370},r.a.createElement(Pe,null))},Xe=function(e){return r.a.createElement(ce,{id:e.id,window_name:"CSV Chart",default_width:840,default_height:370},r.a.createElement(Be,null))},Ye=function(){var e=Object(i.c)((function(e){return e.openwindows}));return r.a.createElement("div",{className:"WorkSpace"},e.map((function(e){return function(e){var t=e.id;switch(e.window_type){case"SelectedFrames":return r.a.createElement(Ge,{key:t,id:t});case"LogList":return r.a.createElement(We,{key:t,id:t});case"AttributesList":return r.a.createElement(Je,{key:t,id:t});case"ImageDisplayer":return r.a.createElement(ze,{key:t,id:t});case"ROIs":return r.a.createElement(He,{key:t,id:t});case"RoiManager":return r.a.createElement($e,{key:t,id:t});case"ChartDisplayer":return r.a.createElement(qe,{key:t,id:t});case"CSVDisplayer":return r.a.createElement(Xe,{key:t,id:t});default:console.log("Unknown window")}}(e)})))},Ze=(a(618),function(){return r.a.createElement("div",null,r.a.createElement(ne,null),r.a.createElement(Ye,null))}),Ke=Object(o.c)(I);Object(c.render)(r.a.createElement(i.a,{store:Ke},r.a.createElement(Ze,null)),document.getElementById("root"))}},[[256,1,2]]]);
//# sourceMappingURL=main.779600a0.chunk.js.map