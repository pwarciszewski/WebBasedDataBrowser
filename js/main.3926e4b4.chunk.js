(this.webpackJsonpwbdb=this.webpackJsonpwbdb||[]).push([[0],{256:function(e,t,n){e.exports=n(619)},268:function(e,t,n){},269:function(e,t,n){},270:function(e,t,n){},271:function(e,t,n){},272:function(e,t,n){},283:function(e,t,n){},284:function(e,t,n){},287:function(e,t,n){},288:function(e,t,n){},289:function(e,t,n){},290:function(e,t,n){},291:function(e,t,n){},292:function(e,t,n){},293:function(e,t,n){},294:function(e,t,n){},295:function(e,t,n){},296:function(e,t,n){},297:function(e,t,n){},602:function(e,t,n){},605:function(e,t){},607:function(e,t){},617:function(e,t,n){},618:function(e,t,n){},619:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(65),i=n(4),o=n(66),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_DATATREE":return t.new_data_tree;default:return e}},l=n(14),s=n(5),d=n(20),f=n(22),m=n.n(f),v=function(e,t){var n=e.findIndex((function(e){return!0===e.focussed})),a=[];-1!==n&&(a=m()(e,Object(d.a)({},n,{focussed:{$set:!1}})));var r,c=Object(s.a)(t);try{var i=function(){var e=r.value,t=e.data.iter_token,n=a.findIndex((function(e){return e.iter_token===t}));-1===n?a=[{iter_token:t,focussed:!1,data_frames:[e]}].concat(Object(l.a)(a)):a[n].data_frames=[e].concat(Object(l.a)(a[n].data_frames))};for(c.s();!(r=c.n()).done;)i()}catch(o){c.e(o)}finally{c.f()}return a[0].focussed=!0,a},p=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,a=[];switch(n.type){case"SET_ACTIVE_FRAMES":return(a=n.active_frames_list.reverse()).forEach((function(e){return e.focussed=!1})),a[0].focussed=!0,a;case"CLEAR_FRAMES":return[];case"ADD_ACTIVE_FRAMES":return v(t,n.new_frames);case"REMOVE_ONE_OF_ACTIVE_FRAMES":var r,c=t.indexOf(n.frame_to_remove);r=t.length>1&c+1<t.length?c+1:c+1===t.length&0!==c?c-1:c;var i=[];return i=t[c].focussed?m()(t,Object(d.a)({},r,{focussed:{$set:!0}})):t,[].concat(Object(l.a)(i.slice(0,c)),Object(l.a)(i.slice(c+1)));case"SET_FOCUS":var o=t.indexOf(n.frame),u=t.findIndex((function(e){return!0===e.focussed})),f=m()(t,(e={},Object(d.a)(e,u,{focussed:{$set:!1}}),Object(d.a)(e,o,{focussed:{$set:!0}}),e));return f;case"FOCUS_NEXT":var p=function(e){var n,a=t.indexOf(e),r=a<t.length-1?a+1:a;return 0!==t.length?m()(t,(n={},Object(d.a)(n,a,{focussed:{$set:!1}}),Object(d.a)(n,r,{focussed:{$set:!0}}),n)):t};return p(n.frame);case"FOCUS_PREVIOUS":var _=function(e){var n,a=t.indexOf(e),r=a>0?a-1:a;return 0!==t.length?m()(t,(n={},Object(d.a)(n,a,{focussed:{$set:!1}}),Object(d.a)(n,r,{focussed:{$set:!0}}),n)):t};return _(n.frame);case"UPDATE_ACTIVE_FRAMES":var h=function(e){var n,a=t,r=Object(s.a)(e);try{var c=function(){var e=n.value,r=t.findIndex((function(t){return t.iter_token===e.data.iter_token})),c=t[r].data_frames.findIndex((function(t){return t.id===e.id}));a=m()(a,Object(d.a)({},r,{data_frames:Object(d.a)({},c,{data:{$set:e.data}})}))};for(r.s();!(n=r.n()).done;)c()}catch(i){r.e(i)}finally{r.f()}return a};return h(n.frames_to_update);default:return t}},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["Welcome to WBDB UI!"],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_LOG":var n=function(t){return e.length<200?[].concat(Object(l.a)(e),[t]):[].concat(Object(l.a)(e.slice(1,200)),[t])};return n(t.text);default:return e}},h=0,E=0,y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_WINDOW":return h+=1,E+=1,[].concat(Object(l.a)(e),[{id:h,window_type:t.window_type,z_index:E}]);case"REMOVE_WINDOW":return[].concat(Object(l.a)(e.slice(0,e.findIndex((function(e){return e.id===t.id})))),Object(l.a)(e.slice(e.findIndex((function(e){return e.id===t.id}))+1)));case"FOCUS_WINDOW":var n=e,a=e.findIndex((function(e){return e.id===t.id}));return-1!==a&&e[a].z_index!==E&&(E+=1,n=m()(e,Object(d.a)({},a,{z_index:{$set:E}}))),n;default:return e}},b=0,O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_IMAGE_ROI":return b+=1,[].concat(Object(l.a)(e),[{roi_id:b,roi_type:t.roi_type,roi_data:t.roi_data,display_roi:t.display_roi}]);case"UPDATE_IMAGE_ROI_XY":var n=function(){var n=e.findIndex((function(e){return e.roi_id===t.roi_id}));return m()(e,Object(d.a)({},n,{roi_data:{x:{$set:t.roi_new_x},y:{$set:t.roi_new_y}}}))};return n();case"UPDATE_IMAGE_ROI_WH":var a=function(){var n=e.findIndex((function(e){return e.roi_id===t.roi_id}));return m()(e,Object(d.a)({},n,{roi_data:{width:{$set:t.roi_new_w},height:{$set:t.roi_new_h}}}))};return a();case"SET_ROI_DISPLAY":var r=function(){var n=e.findIndex((function(e){return e.roi_id===t.roi_id}));return m()(e,Object(d.a)({},n,{display_roi:{$set:t.display_roi}}))};return r();case"REMOVE_ROI":return[].concat(Object(l.a)(e.slice(0,e.findIndex((function(e){return e.roi_id===t.roi_id})))),Object(l.a)(e.slice(e.findIndex((function(e){return e.roi_id===t.roi_id}))+1)));default:return e}},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_OPERATIONS":var n=[],a=function(a){e.some((function(e){return e.operation_name===a}))||n.push({operation_name:a,operation_properties:t.available_ops_list[a]})};for(var r in t.available_ops_list)a(r);return[].concat(Object(l.a)(e),n);case"UPDATE_OPERATION":var c=e.findIndex((function(e){return e.operation_name===t.updated_operation.operation_name})),i=m()(e,Object(d.a)({},c,{operation_properties:{$set:t.updated_operation.operation_properties}}));return i;default:return e}},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NEW_ROUTINE":return[t.new_routine];case"ADD_OPERATION":var n=function(t){var n=e[0];return n.push(t),n};return[n(t.operation)];case"REMOVE_OPERATION":var a=function(t){return[].concat(Object(l.a)(e[0].slice(0,t)),Object(l.a)(e[0].slice(t+1)))};return[a(t.index)];case"CHANGE_OPERATION":var r=function(t,n,a){var r=e[0];return r[t].params[n]=a,r};return[r(t.index,t.param,t.value)];default:return e}},j=Object(o.b)({datatree:u,activeframes:p,loglist:_,openwindows:y,imagerois:O,availableops:g,serverroutine:I}),N=n(150),S=n.n(N),w=n(250),x="/DataBrowse";function k(){return C.apply(this,arguments)}function C(){return(C=Object(w.a)(S.a.mark((function e(){var t,n,a,r=arguments;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:"",n=r.length>1&&void 0!==r[1]?r[1]:{},e.next=4,fetch(t,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(n)});case 4:return a=e.sent,e.abrupt("return",a.json());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){fetch(x+"/getnewestid/").then((function(e){return e.json()})).then((function(t){e(t)})).catch((function(e){return console.log(e)}))}function A(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];k(x+"/fetchdata/",{selected:t,group_by_iter:n}).then((function(t){e(t)})).catch((function(e){return console.log(e)}))}var T=function(e){return{type:"SET_FOCUS",frame:e}},D=function(e){return{type:"ADD_LOG",text:e}},z=function(e){return{type:"ADD_WINDOW",window_type:e}},M=function(e){return{type:"FOCUS_WINDOW",id:e}},L=function(e,t,n){return{type:"ADD_IMAGE_ROI",roi_type:e,roi_data:t,display_roi:n}},P=function(e,t,n){return{type:"UPDATE_IMAGE_ROI_XY",roi_id:e,roi_new_x:t,roi_new_y:n}},F=function(e){return{type:"SET_NEW_ROUTINE",new_routine:e}},V=function(e,t,n){return{type:"CHANGE_OPERATION",index:e,param:t,value:n}},U=n(251),W=n.n(U);n(267),n(268);var B=function(){var e=Object(i.c)((function(e){return e.datatree})),t=Object(i.b)(),n=Object(i.c)((function(e){return function(e){var t,n=0,a=Object(s.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;n<r.z_index&&(n=r.z_index)}}catch(c){a.e(c)}finally{a.f()}return n+1}(e.openwindows)}));return r.a.createElement("div",{className:"DataTree",style:{zIndex:n}},r.a.createElement(W.a,{data:e,onChange:function(n,a){A((function(e){t({type:"SET_ACTIVE_FRAMES",active_frames_list:e})}),function e(t){var n=[];for(var a in t)t[a].hasOwnProperty("value")?n.push(Number(t[a].value)):n.push.apply(n,Object(l.a)(e(t[a].children)));return n}(function(e,t){var n=[];for(var a in e){var r=e[a]._id.split("-");r.shift();var c=(r=r.map((function(e){return Number(e)}))).pop(),i=t;for(var o in r)i=i[r[o]].children;i=i[c],n.push(i)}return n}(a,e)),!0)},onFocus:function(){var e;e=function(e){t({type:"LOAD_DATATREE",new_data_tree:e})},fetch(x+"/getdatatree/").then((function(e){return e.json()})).then((function(t){e(t)})).catch((function(e){return console.log(e)}))},keepTreeOnSearch:!0,showPartiallySelected:!0,texts:{placeholder:"Select frames..."}}))},G=n(8),$=(n(269),function(){var e=Object(i.b)(),t=Object(a.useState)(0),n=Object(G.a)(t,2),c=n[0],o=n[1],u=Object(a.useState)(!1),l=Object(G.a)(u,2),s=l[0],d=l[1],f=Object(a.useState)(0),m=Object(G.a)(f,2),v=m[0],p=m[1];return Object(a.useEffect)((function(){var t=setInterval((function(){!function(t,n,a){if(t&&(R((function(e){p(e)})),a!==n)){e(D("Detected new frame(s)!"));for(var r=[],c=a+1;c<=n;c++)r.push(c);o(n),A((function(t){e({type:"ADD_ACTIVE_FRAMES",new_frames:t})}),r)}}(s,v,c)}),500);return function(){return clearInterval(t)}}),[s,v,c]),r.a.createElement("div",{className:"NewDataWatcher",active:s.toString(),onClick:function(){return s||(e(D("Watching for new frames...")),R((function(e){p(e),o(e)}))),void d(!s)}},r.a.createElement("div",{className:"displaytext"},"Loading new frames: ",String(s)))}),J=(n(270),function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return function(e){var t,n=0,a=Object(s.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;n<r.z_index&&(n=r.z_index)}}catch(c){a.e(c)}finally{a.f()}return n+1}(e.openwindows)}));return r.a.createElement("div",{className:"AddWindowSelection"},r.a.createElement("div",{className:"dropdown"},"Add new window ","\u25bc"),r.a.createElement("div",{className:"dropdown-content",style:{zIndex:t}},r.a.createElement("div",{className:"dropdown-selection",onClick:function(){return e(z("SelectedFrames"))}},"Selected frames"),r.a.createElement("div",{className:"dropdown-selection",onClick:function(){return e(z("LogList"))}},"Application logs"),r.a.createElement("div",{className:"dropdown-selection",onClick:function(){return e(z("AttributesList"))}},"Attributes list"),r.a.createElement("div",{className:"dropdown-selection",onClick:function(){return e(z("ImageDisplayer"))}},"Image displayer"),r.a.createElement("div",{className:"dropdown-selection",onClick:function(){return e(z("ROIs"))}},"Display ROIs"),r.a.createElement("div",{className:"dropdown-selection",onClick:function(){return e(z("RoiManager"))}},"ROIs manager"),r.a.createElement("div",{className:"dropdown-selection",onClick:function(){return e(z("ChartDisplayer"))}},"Graph displayer"),r.a.createElement("div",{className:"dropdown-selection",onClick:function(){return e(z("CSVDisplayer"))}},"CSV displayer")))}),H=(n(271),function(){var e=Object(i.c)((function(e){return e.activeframes})),t=e.reduce((function(e,t){return function(e,t){var n=[],a=t.data_frames;if(void 0!==a){var r,c=Object(s.a)(a);try{for(c.s();!(r=c.n()).done;){var i=r.value;n.push(i.id)}}catch(o){c.e(o)}finally{c.f()}}return e.concat(n)}(e,t)}),[]);return r.a.createElement("div",{className:"FileDownloader"},r.a.createElement("form",{action:x+"/download/",method:"post",id:"formdownload",onSubmit:function(e){return function(e){window.confirm("Zipping files might take a while. Click OK to proceed")||e.preventDefault()}(e)}},r.a.createElement("input",{id:"container_for_ids",type:"hidden",name:"ids",value:[JSON.stringify(t)]}),r.a.createElement("button",{type:"submit"},"Download")))}),q=(n(272),n(151)),X=n.n(q),Y=n(53),Z=(n(282),function(e){var t=e.variable,n=e.value,a=e.handleValueChange;return r.a.createElement("div",{className:"Variable"},r.a.createElement("label",null,t+": "),r.a.createElement("input",{type:"text",defaultValue:n,onChange:function(e){return a(e.target.value)}}),r.a.createElement("br",null))}),K=function(e){var t=e.index,n=e.param_name,a=e.value,c=Object(i.b)(),o=Object(i.c)((function(e){return e.imagerois}));return r.a.createElement("div",{className:"VariableDesigner"},r.a.createElement("label",null,n+": "),r.a.createElement("input",{defaultValue:a,type:"text",onChange:function(e){return c(V(t,n,e.target.value))}}),r.a.createElement("select",{onChange:function(e){return function(e){"INIT"!==e&&c(V(t,n,e))}(e.target.value)}},r.a.createElement("option",{value:"INIT"}," Select ROI"),function(e){var t,n=[],a=Object(s.a)(e);try{for(a.s();!(t=a.n()).done;){var c=t.value;for(var i in c.roi_data)n.push(r.a.createElement("option",{value:c.roi_data[i],key:"ID "+c.roi_id+"; "+i},"ID "+c.roi_id+"; "+i))}}catch(o){a.e(o)}finally{a.f()}return n}(o)))},Q=function(e){var t=e.operation,n=e.index,a=Object(i.b)();return r.a.createElement("div",{className:"Operation"},r.a.createElement("div",null,t.operation," ",r.a.createElement("button",{className:"close",onClick:function(){return a(function(e){return{type:"REMOVE_OPERATION",index:e}}(n))}},"\u2715")),r.a.createElement("div",null,function(){var e=[];for(var a in t.params)e.push(r.a.createElement(K,{key:a,index:n,param_name:a,value:t.params[a]}));return e}()))},ee=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.serverroutine}))[0],n=Object(i.c)((function(e){return e.availableops})),c=Object(a.useState)("INIT"),o=Object(G.a)(c,2),u=o[0],l=o[1];return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("select",{value:u,onChange:function(e){return l(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select operation"),function(e){var t,n,a=[],c=Object(s.a)(e);try{for(c.s();!(t=c.n()).done;){var i=t.value;a.push(r.a.createElement("option",{value:JSON.stringify((n=i,{operation:n.operation_name,params:n.operation_properties.variables})),key:i.operation_name},i.operation_name))}}catch(o){c.e(o)}finally{c.f()}return a}(n)),r.a.createElement("button",{onClick:function(){var t;"INIT"!==(t=u)&&e(function(e){return{type:"ADD_OPERATION",operation:e}}(JSON.parse(t)))}},"Add operation")),r.a.createElement("div",null,function(e){var t,n=[],a=Object(s.a)(e.entries());try{for(a.s();!(t=a.n()).done;){var c=Object(G.a)(t.value,2),i=c[0],o=c[1];n.push(r.a.createElement(Q,{operation:o,index:i,key:i}))}}catch(u){a.e(u)}finally{a.f()}return n}(t)),r.a.createElement("div",{className:"UploadNewRoutineSpace"},r.a.createElement("button",{onClick:function(){return n=function(t){return e(D(t))},void k(x+"/setRoutine/",{new_routine:t}).then((function(){return n("Routine updated")})).catch((function(e){return console.log(e)}));var n}},"Upload new routine")))};X.a.setAppElement("#root");var te={content:{top:"40%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",fontFamily:"Arial, Helvetica, sans-serif",background:"#f4f4f4"},overlay:{backgroundColor:"rgba(0,0,0,0.4)",zIndex:1}},ne=function(e){return r.a.createElement("option",{key:e,value:e},e)},ae=function(e,t,n){return"FOCUSSED"===t?function(e,t){var n=e.find((function(e){return!0===e.focussed}));if(void 0===n)return[];var a,r=[],c=Object(s.a)(n.data_frames);try{for(c.s();!(a=c.n()).done;){var i=a.value;("ALL"===t||i.data.data_source===t)&&r.push(i.id)}}catch(o){c.e(o)}finally{c.f()}return r}(e,n):function(e,t,n){var a,r=[],c=Object(s.a)(e);try{for(c.s();!(a=c.n()).done;){var i,o=a.value,u=Object(s.a)(o.data_frames);try{for(u.s();!(i=u.n()).done;){var l=i.value;"ALL"===n?l.data.sequence_name===t&&r.push(l.id):l.data.sequence_name===t&&l.data.data_source===n&&r.push(l.id)}}catch(d){u.e(d)}finally{u.f()}}}catch(d){c.e(d)}finally{c.f()}return r}(e,t,n)},re=function(){var e=Object(i.b)(),t=Object(a.useState)(!1),n=Object(G.a)(t,2),c=n[0],o=n[1],u=function(){var t;t=function(t){return e(F(t))},fetch(x+"/fetchRoutine/").then((function(e){return e.json()})).then((function(e){return t(e)})).catch((function(e){return console.log(e)})),function(e){fetch(x+"/fetchOps/").then((function(e){return e.json()})).then((function(t){e(t)})).catch((function(e){return console.log(e)}))}((function(t){return e({type:"INITIALIZE_OPERATIONS",available_ops_list:t})})),o(!0)},l=Object(i.c)((function(e){return function(e){var t,n=0,a=Object(s.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;n<r.z_index&&(n=r.z_index)}}catch(c){a.e(c)}finally{a.f()}return n+1}(e.openwindows)}));te.overlay.zIndex=l;var d=Object(i.c)((function(e){return e.availableops})),f=Object(i.c)((function(e){return e.activeframes})),m=function(e){var t,n=[],a=Object(s.a)(e);try{for(a.s();!(t=a.n()).done;){var r,c=t.value,i=Object(s.a)(c.data_frames);try{for(i.s();!(r=i.n()).done;){var o=r.value;n.includes(o.data.sequence_name)||n.push(o.data.sequence_name)}}catch(u){i.e(u)}finally{i.f()}}}catch(u){a.e(u)}finally{a.f()}return n}(f),v=function(e){var t,n=[],a=Object(s.a)(e);try{for(a.s();!(t=a.n()).done;){var r,c=t.value,i=Object(s.a)(c.data_frames);try{for(i.s();!(r=i.n()).done;){var o=r.value.data.data_source;n.includes(o)||n.push(o)}}catch(u){i.e(u)}finally{i.f()}}}catch(u){a.e(u)}finally{a.f()}return n}(f),p=Object(a.useState)("FOCUSSED"),_=Object(G.a)(p,2),h=_[0],E=_[1],y=Object(a.useState)("ALL"),b=Object(G.a)(y,2),O=b[0],g=b[1],I=Object(a.useState)({}),j=Object(G.a)(I,2),N=j[0],S=j[1],w=Object(a.useState)("INIT"),C=Object(G.a)(w,2),R=C[0],T=C[1],z=Object(i.c)((function(e){return e.imagerois})),M=Object(a.useState)("INIT"),L=Object(G.a)(M,2),P=L[0],V=L[1],U=function(e,t,n){var a=e;a.operation_properties.variables[t]=n,S(a)};return r.a.createElement("div",{className:"OperationsMenuButton"},r.a.createElement("button",{onClick:function(){return u()}},"Operations menu"),r.a.createElement(X.a,{isOpen:c,style:te,shouldCloseOnOverlayClick:!0,onRequestClose:function(){return o(!1)}},r.a.createElement(Y.d,null,r.a.createElement(Y.b,null,r.a.createElement(Y.a,null,"Dispatch operation"),r.a.createElement(Y.a,null,"Routines designer")),r.a.createElement(Y.c,null,r.a.createElement("div",null,r.a.createElement("h2",null,"Operations Menu"),r.a.createElement("h3",null,"Selected frames"),r.a.createElement("select",{value:O,onChange:function(e){return g(e.target.value)}},r.a.createElement("option",{key:"ALL",value:"ALL"},"All devices"),v.map((function(e){return ne(e)}))),r.a.createElement("select",{value:h,onChange:function(e){return E(e.target.value)}},r.a.createElement("option",{key:"FOCUSSED",value:"FOCUSSED"},"Currently focussed frame"),m.map((function(e){return ne(e)}))),r.a.createElement("h3",null,"Operation options"),r.a.createElement("select",{value:R,onChange:function(e){return t=e.target.value,T(t),void S(d.find((function(e){return e.operation_name===t})));var t}},r.a.createElement("option",{key:"INIT",value:"INIT"}," Select operation"),d.map((function(e){return function(e){var t=e.operation_name;return r.a.createElement("option",{key:t,value:t},t)}(e)})))," ",r.a.createElement("br",null),"bind to ROI:",r.a.createElement("select",{value:P,onChange:function(e){return V(e.target.value)}},r.a.createElement("option",{value:"INIT"}," Nothing "),z.map((function(e){return r.a.createElement("option",{key:e.roi_id,value:e.roi_id},"ID: ",e.roi_id)}))),function(e,t){var n=[],a=void 0===t?{}:t;try{var c=function(t){a.hasOwnProperty("roi_data")&&a.roi_data.hasOwnProperty(t)||n.push(r.a.createElement(Z,{variable:t,value:e.operation_properties.variables[t],handleValueChange:function(e){return U(N,t,e)},key:t}))};for(var i in e.operation_properties.variables)c(i)}catch(o){return r.a.createElement("h4",null,"Select operation")}return n}(N,z.find((function(e){return e.roi_id==P})))),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){"INIT"!==R&&function(e,t,n,a,r){a("Starting "+n+"..."),k(x+"/do/",{selected:e,parameters:t,operation:n}).then((function(e){return a(e)})).then((function(){return A(r,e)})).catch((function(e){return console.log(e)}))}(ae(f,h,O),function(e,t){var n=e.hasOwnProperty("operation_properties")?e:{operation_properties:{variables:{}}},a=void 0===t?{roi_data:{}}:t,r={};for(var c in n.operation_properties.variables)a.roi_data.hasOwnProperty(c)?r[c]=a.roi_data[c]:r[c]=n.operation_properties.variables[c];return r}(N,z.find((function(e){return e.roi_id==P}))),R,(function(t){return e(D(t))}),(function(t){return e({type:"UPDATE_ACTIVE_FRAMES",frames_to_update:t})}))}},"Dispatch!"))),r.a.createElement(Y.c,null,r.a.createElement(ee,null)))))},ce=(n(283),function(){return r.a.createElement("div",{className:"MenuBar"},r.a.createElement(B,null),r.a.createElement(H,null),r.a.createElement($,null),r.a.createElement(re,null),r.a.createElement(J,null))}),ie=(n(284),n(68)),oe=(n(287),function(e){var t=Object(i.b)();return r.a.createElement(ie.a,{bounds:".WorkSpace",className:"WindowWrapper",dragHandleClassName:"header",resizeGrid:[20,20],dragGrid:[20,20],default:{x:0,y:0,width:e.default_width,height:e.default_height},lockAspectRatio:e.lock_aspect_ratio,enableResizing:e.resizable,onDragStart:function(){return t(M(e.id))},onClick:function(){return t(M(e.id))},style:{zIndex:e.z_index}},r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"header-name"},e.window_name),r.a.createElement("div",{className:"header-close",onClick:function(){return t({type:"REMOVE_WINDOW",id:e.id})}},"\u2715")),e.children)}),ue=(n(288),function(e,t,n){var a="";try{var r=e.data_frames.findIndex((function(e){return e.data.data_source==t}));a=""+(a=e.data_frames[r].data.results[n].value)}catch(c){a="/static/DataBrowse/img/no_img.png"}return a}),le=function(e){var t=e.iter_frame,n=e.img_source_device,a=e.img_source_result,c=Object(i.b)();return r.a.createElement("div",{className:"DataTile",focussed:t.focussed.toString()},r.a.createElement("div",{className:"TileContent",onClick:function(){return c(T(t))}},r.a.createElement("img",{className:"TileImage",src:ue(t,n,a),height:70,width:70}),t.data_frames[0].data.sequence_name,r.a.createElement("div",{className:"FileList"},"Files' sources in this iteration:",t.data_frames.map((function(e){return r.a.createElement("div",{key:e.id}," ",e.data.data_source," ")})))),r.a.createElement("div",{className:"close",onClick:function(){return c({type:"REMOVE_ONE_OF_ACTIVE_FRAMES",frame_to_remove:t})}},"\u2715"))},se=(n(289),function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.activeframes})).find((function(e){return!0===e.focussed}));return r.a.createElement("div",{className:"NavigButtons"},r.a.createElement("button",{className:"NavigButton",onClick:function(){return e({type:"FOCUS_PREVIOUS",frame:t})}}," ","\u25c0"," "),r.a.createElement("button",{className:"NavigButton",onClick:function(){return e({type:"CLEAR_FRAMES"})}}," Clear "),r.a.createElement("button",{className:"NavigButton",onClick:function(){return e({type:"FOCUS_NEXT",frame:t})}}," ","\u25b6"," "))}),de=(n(290),function(){var e=Object(i.c)((function(e){return e.activeframes})),t=e.find((function(e){return!0===e.focussed})),n=Object(a.useRef)(null),c=Object(a.useRef)(null);Object(a.useEffect)((function(){return function(e,t){if(null!==e.current){var n=e.current.offsetTop-t.current.scrollTop;(n>t.current.clientHeight||n<0)&&t.current.scrollTo(0,e.current.offsetTop-100)}}(n,c)}));var o=Object(a.useState)("INIT"),u=Object(G.a)(o,2),l=u[0],d=u[1],f=Object(a.useState)("INIT"),m=Object(G.a)(f,2),v=m[0],p=m[1],_=function(e){var t,n=[],a=Object(s.a)(e);try{for(a.s();!(t=a.n()).done;){var r,c=t.value,i=Object(s.a)(c.data_frames);try{for(i.s();!(r=i.n()).done;){var o=r.value.data.data_source;n.includes(o)||n.push(o)}}catch(u){i.e(u)}finally{i.f()}}}catch(u){a.e(u)}finally{a.f()}return n}(e),h=function(e,t){var n,a=[],r=Object(s.a)(t);try{for(r.s();!(n=r.n()).done;){var c,i=n.value,o=Object(s.a)(i.data_frames);try{for(o.s();!(c=o.n()).done;){var u=c.value;for(var l in u.data.results)"IMG"===u.data.results[l].type&&u.data.data_source===e&&(a.includes(l)||a.push(l))}}catch(d){o.e(d)}finally{o.f()}}}catch(d){r.e(d)}finally{r.f()}return a}(l,e);return r.a.createElement("div",{className:"SelectedFramesList"},r.a.createElement(se,null),r.a.createElement("div",{className:"SourceSelection"},r.a.createElement("select",{value:l,onChange:function(e){return d(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select device"),_.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)}))),r.a.createElement("select",{value:v,onChange:function(e){return p(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select result"),h.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)})))),r.a.createElement("div",{className:"TilesSpace",ref:c},e.map((function(e){return e.iter_token===t.iter_token?r.a.createElement("div",{ref:n,key:e.iter_token},r.a.createElement(le,{key:e.iter_token,iter_frame:e,img_source_device:l,img_source_result:v})):r.a.createElement("div",{key:e.iter_token},r.a.createElement(le,{key:e.iter_token,iter_frame:e,img_source_device:l,img_source_result:v}))}))))}),fe=(n(291),function(){var e=Object(i.c)((function(e){return e.loglist})),t=r.a.createRef();return Object(a.useEffect)((function(){t.current.scrollTop=t.current.scrollHeight})),r.a.createElement("div",{className:"Console",ref:t},r.a.createElement("ul",null,e.map((function(e,t){return r.a.createElement("li",{key:e+t},e)}))))}),me=function(e){return void 0!==e?r.a.createElement("td",null,e):""},ve=function(e){var t=e.props;return r.a.createElement("tr",null,me(t.name),me(t.type),me(t.value))},pe=(n(292),function(){var e=Object(i.c)((function(e){return e.activeframes})).find((function(e){return!0===e.focussed})),t=function(e){var t=[];if(void 0!==e){var n,a=Object(s.a)(e.data_frames);try{for(a.s();!(n=a.n()).done;){var r=n.value.data.data_source;t.includes(r)||t.push(r)}}catch(c){a.e(c)}finally{a.f()}}return t}(e),n=Object(a.useState)("PROPS"),c=Object(G.a)(n,2),o=c[0],u=c[1],l=Object(a.useState)("INIT"),d=Object(G.a)(l,2),f=d[0],m=d[1];return r.a.createElement("div",{className:"FrameAttributesList"},r.a.createElement("label",null,"Display:",r.a.createElement("select",{value:f,onChange:function(e){return m(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select device"),t.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)}))),r.a.createElement("select",{value:o,onChange:function(e){return u(e.target.value)}},r.a.createElement("option",{value:"PROPS"},"Properties"),r.a.createElement("option",{value:"RES"},"Results"))),r.a.createElement("div",{className:"tableSpace"},r.a.createElement("table",null,r.a.createElement("tbody",null,"RES"===o?r.a.createElement("tr",null,r.a.createElement("th",null,"Result Name"),r.a.createElement("th",null,"Result Type"),r.a.createElement("th",null,"Result Value")):r.a.createElement("tr",null,r.a.createElement("th",null,"Property Name"),r.a.createElement("th",null,"Property Value")),function(e,t,n){if(void 0===e||"INIT"===n)return[];var a=[],r=e.data_frames.findIndex((function(e){return e.data.data_source===n}));if(-1===r)return[];var c="PROPS"===t?e.data_frames[r].data.properties:e.data_frames[r].data.results;for(var i in c)"RES"===t?a.push({name:i,type:c[i].type,value:c[i].value}):a.push({name:i,value:c[i]});return a}(e,o,f).map((function(e,t){return r.a.createElement(ve,{key:t,props:e})}))))))}),_e=function(e,t,n){var a="";try{var r=e.data_frames.findIndex((function(e){return e.data.data_source===n}));a=""+(a=e.data_frames[r].data.results[t].value)}catch(c){a="/static/DataBrowse/img/no_img.png"}return a},he=function(e){return r.a.createElement("img",{className:"SelectedImage",src:_e(e.iter_frame,e.result,e.device)})},Ee=(n(293),function(){var e=Object(i.c)((function(e){return e.activeframes})).find((function(e){return!0===e.focussed})),t=Object(a.useState)("INIT"),n=Object(G.a)(t,2),c=n[0],o=n[1],u=Object(a.useState)("INIT"),l=Object(G.a)(u,2),d=l[0],f=l[1],m=function(e){var t=[];if(void 0!==e){var n,a=Object(s.a)(e.data_frames);try{for(a.s();!(n=a.n()).done;){var r=n.value.data.data_source;t.includes(r)||t.push(r)}}catch(c){a.e(c)}finally{a.f()}}return t}(e),v=function(e,t){var n=[];if(void 0!==e){var a=e.data_frames.findIndex((function(e){return e.data.data_source===t}));if(-1===a)return["None"];for(var r in e.data_frames[a].data.results)"IMG"===e.data_frames[a].data.results[r].type&&n.push(r)}else n.push("None");return n}(e,c);return r.a.createElement("div",{className:"ImageDisplayer"},r.a.createElement("div",{className:"ResultSelect"},r.a.createElement("select",{value:c,onChange:function(e){return o(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select device"),m.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)}))),r.a.createElement("select",{value:d,onChange:function(e){return f(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select result to show"),v.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)})))),r.a.createElement(he,{iter_frame:e,result:d,device:c}))}),ye=function(e,t,n){var a="";try{var r=e.data_frames.findIndex((function(e){return e.data.data_source===n}));a=""+(a=e.data_frames[r].data.results[t].value)}catch(c){a="/static/DataBrowse/img/no_img.png"}return a},be=function(e){return r.a.createElement("div",{className:"SelectedImageRoi"},r.a.createElement("img",{className:"ImageRoi",src:ye(e.iter_frame,e.result,e.device),onLoad:function(t){return e.imgOnload(t.target.naturalWidth,t.target.naturalHeight)}}),e.children)},Oe=(n(294),function(e){var t=Object(i.c)((function(e){return e.activeframes})).find((function(e){return!0===e.focussed})),n=Object(a.useState)("INIT"),c=Object(G.a)(n,2),o=c[0],u=c[1],l=Object(a.useState)("INIT"),d=Object(G.a)(l,2),f=d[0],m=d[1],v=function(e){var t=[];if(void 0!==e){var n,a=Object(s.a)(e.data_frames);try{for(a.s();!(n=a.n()).done;){var r=n.value.data.data_source;t.includes(r)||t.push(r)}}catch(c){a.e(c)}finally{a.f()}}return t}(t),p=function(e,t){var n=[];if(void 0!==e){var a=e.data_frames.findIndex((function(e){return e.data.data_source===t}));if(-1===a)return["None"];for(var r in e.data_frames[a].data.results)"IMG"===e.data_frames[a].data.results[r].type&&n.push(r)}else n.push("None");return n}(t,o);return r.a.createElement("div",{className:"ImageDisplayerRoi"},r.a.createElement("div",{className:"ResultSelect"},r.a.createElement("select",{value:o,onChange:function(e){return u(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select device"),v.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)}))),r.a.createElement("select",{value:f,onChange:function(e){return m(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select result to show"),p.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)})))),r.a.createElement(be,{iter_frame:t,result:f,device:o,imgOnload:e.imgOnload},e.children))}),ge=function(e){var t=e.placement,n=e.id,a=e.onDrag,c=e.onResize;return r.a.createElement(ie.a,{position:{x:t.x,y:t.y},size:{width:t.width,height:t.height},title:n,bounds:".SelectedImageRoi",onDragStop:function(e,t){a(n,t.x,t.y)},onResizeStop:function(e,t,a,r,i){c(n,i.x,i.y,a.offsetWidth,a.offsetHeight)}},r.a.createElement("div",{className:"Rectangle"}))},Ie=function(e){var t=e.placement,n=e.id,a=e.onDrag;return r.a.createElement(ie.a,{position:{x:t.x,y:t.y},size:{width:20,height:20},title:n,enableResizing:!1,bounds:".SelectedImageRoi",onDragStop:function(e,t){a(n,t.x,t.y)}},r.a.createElement("div",{className:"Point"},"\u2715"))},je=(n(295),function(){var e=Object(a.useState)(0),t=Object(G.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(0),u=Object(G.a)(o,2),l=(u[0],u[1]),s=Object(i.b)(),d=function(e){var t=n/600;return t>1?{x:Math.round(e.x/t),y:Math.round(e.y/t),width:Math.round(e.width/t),height:Math.round(e.height/t)}:e},f=function(e){var t=n/600;return t>1?{x:Math.round(e.x/t-12),y:Math.round(e.y/t-12)}:{x:Math.round(e.x-12),y:Math.round(e.y-12)}},m=function(e){var t=n/600;return t>1?Math.round(e*t):e},v=function(e){var t=n/600;return t>1?Math.round(e*t+12*t):e+12},p=function(e,t,n){s(P(e,m(t),m(n)))},_=function(e,t,n){s(P(e,v(t),v(n)))},h=function(e,t,n,a,r){var c,i,o;s(P(e,m(t),m(n))),s((c=e,i=m(a),o=m(r),{type:"UPDATE_IMAGE_ROI_WH",roi_id:c,roi_new_w:i,roi_new_h:o}))},E=Object(i.c)((function(e){return e.imagerois})).filter((function(e){return!0===e.display_roi}));return r.a.createElement("div",{className:"SelectRoi"},r.a.createElement(Oe,{imgOnload:function(e,t){c(e),l(t)}},E.map((function(e){return function(e){switch(e.roi_type){case"RECTANGLE":return r.a.createElement(ge,{key:e.roi_id,id:e.roi_id,placement:d(e.roi_data),onDrag:p,onResize:h});case"POINT":return r.a.createElement(Ie,{key:e.roi_id,id:e.roi_id,placement:f(e.roi_data),onDrag:_})}}(e)}))))}),Ne=(n(296),function(e){var t=e.roi,n=Object(i.b)();return r.a.createElement("div",{className:"RoiTile"},"ROI ID: ",t.roi_id," ",r.a.createElement("input",{type:"checkbox",checked:t.display_roi,onClick:function(){return n((e=t.roi_id,a=!t.display_roi,{type:"SET_ROI_DISPLAY",roi_id:e,display_roi:a}));var e,a}}),r.a.createElement("div",{className:"close",onClick:function(){return n({type:"REMOVE_ROI",roi_id:t.roi_id})}},"\u2715"),r.a.createElement("br",null),"type: ",t.roi_type," ",r.a.createElement("br",null),JSON.stringify(t.roi_data,null,1))}),Se=(n(297),{x:0,y:0,width:200,height:200}),we={x:200,y:200},xe=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.imagerois}));return r.a.createElement("div",{className:"RoiManager"},r.a.createElement("div",{className:"RoiButtons"},r.a.createElement("button",{className:"AddButton",onClick:function(){return e(L("RECTANGLE",Se,!0))}},"Add rectangle"),r.a.createElement("button",{className:"AddButton",onClick:function(){return e(L("POINT",we,!0))}},"Add point")),r.a.createElement("div",{className:"RoisList"},t.map((function(e){return r.a.createElement(Ne,{key:e.roi_id,roi:e})}))))},ke=n(105),Ce=n.n(ke),Re=(n(602),["#111d5e","#c70039","#f37121","#ffbd69","#086972","#01a9b4","#87dfd6","#fbfd8a","#184d47","#96bb7c"]),Ae=function e(t,n){if(!n||!t)return!1;if(t.length!=n.length)return!1;for(var a=0,r=t.length;a<r;a++)if(t[a]instanceof Array&&n[a]instanceof Array){if(e(!t[a],n[a]))return!1}else if(t[a]!=n[a])return!1;return!0},Te=function(e){return e[0]+" result: "+e[1]},De=function(e){return e[0]+" property: "+e[1]},ze=function(e,t){var n={};if("INIT"!==t){var a=JSON.parse(t),r=a[0],c=a[1];switch(a[2]){case"property":var i,o=Object(s.a)(e);try{for(o.s();!(i=o.n()).done;){var u,l=i.value,d=Object(s.a)(l.data_frames);try{for(d.s();!(u=d.n()).done;){var f=u.value;try{f.data.data_source===r&&(n[f.id]=[f.data.properties[c],f.data.iter_token])}catch(y){}}}catch(b){d.e(b)}finally{d.f()}}}catch(b){o.e(b)}finally{o.f()}case"result":var m,v=Object(s.a)(e);try{for(v.s();!(m=v.n()).done;){var p,_=m.value,h=Object(s.a)(_.data_frames);try{for(h.s();!(p=h.n()).done;){var E=p.value;try{E.data.data_source===r&&(n[E.id]=[E.data.results[c].value,E.data.iter_token])}catch(y){}}}catch(b){h.e(b)}finally{h.f()}}}catch(b){v.e(b)}finally{v.f()}}}return n},Me=function(e){var t,n=function(e){var t,n=[],a=Object(s.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;n.includes(r.data_frames[0].data.sequence_name)||n.push(r.data_frames[0].data.sequence_name)}}catch(c){a.e(c)}finally{a.f()}return n}(e),a={},r=Object(s.a)(n.entries());try{for(r.s();!(t=r.n()).done;){var c=Object(G.a)(t.value,2),i=c[0];a[c[1]]=Re[i%Re.length]}}catch(p){r.e(p)}finally{r.f()}var o,u={},l=Object(s.a)(e);try{for(l.s();!(o=l.n()).done;){var d,f=o.value,m=Object(s.a)(f.data_frames);try{for(m.s();!(d=m.n()).done;){var v=d.value;u[v.id]=a[v.data.sequence_name]}}catch(p){m.e(p)}finally{m.f()}}}catch(p){l.e(p)}finally{l.f()}return u},Le=function(e,t,n,a,r){var c="",i="";if("INIT"!==t){var o=JSON.parse(t);c=o[0]+": "+o[1]}if("INIT"!==n){var u=JSON.parse(n);i=u[0]+": "+u[1]}var l,d={backgroundColor:"#f4f4f4",tooltip:{trigger:"axis",showContent:!1,axisPointer:{type:"cross"}},xAxis:{min:a.min_x,max:a.max_x,name:c,nameLocation:"center",type:"value",splitLine:{lineStyle:{type:"dashed"}}},yAxis:{min:a.min_y,max:a.max_y,name:i,type:"value",splitLine:{lineStyle:{type:"dashed"}}},series:[]},f=Object(s.a)(e);try{for(f.s();!(l=f.n()).done;){var m=l.value;d.series.push({name:m.iter_token,data:[m.data],type:"scatter",color:r[m.id],emphasis:{label:{show:!0,position:"left",color:"black",fontSize:16}}})}}catch(v){f.e(v)}finally{f.f()}return d},Pe=function(e,t){var n,a=[],r=Object(s.a)(t);try{for(r.s();!(n=r.n()).done;){var c=n.value;a.push(c.data)}}catch(i){r.e(i)}finally{r.f()}!function(e,t){for(var n=function(e){for(var t="",n=0;n<e.length;n++){var a=null===e[n]?"":e[n].toString();e[n]instanceof Date&&(a=e[n].toLocaleString());var r=a.replace(/"/g,'""');r.search(/("|,|\n)/g)>=0&&(r='"'+r+'"'),n>0&&(t+=","),t+=r}return t+"\n"},a="",r=0;r<t.length;r++)a+=n(t[r]);var c=new Blob([a],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(c,e);else{var i=document.createElement("a");if(void 0!==i.download){var o=URL.createObjectURL(c);i.setAttribute("href",o),i.setAttribute("download",e),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}}}(e,a)},Fe=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.activeframes})),n=Me(t),c=Object(a.useState)("INIT"),o=Object(G.a)(c,2),u=o[0],l=o[1],d=Object(a.useState)("INIT"),f=Object(G.a)(d,2),m=f[0],v=f[1],p=function(e){var t,n={},a=[],r=[],c=Object(s.a)(e);try{for(c.s();!(t=c.n()).done;){var i,o=t.value,u=Object(s.a)(o.data_frames);try{for(u.s();!(i=u.n()).done;){var l=i.value,d=function(e){var t=[l.data.data_source,e,"property"];a.some((function(e){return Ae(e,t)}))||a.push(t)};for(var f in l.data.properties)d(f);var m=function(e){var t=[l.data.data_source,e,"result"];r.some((function(e){return Ae(e,t)}))||"NUM"!==l.data.results[e].type||r.push(t)};for(var v in l.data.results)m(v)}}catch(p){u.e(p)}finally{u.f()}}}catch(p){c.e(p)}finally{c.f()}return n.properties=a,n.results=r,n}(t),_=function(e,t){var n=[];for(var a in e)if(t.hasOwnProperty(a)){var r={};r.id=a,r.data=[Number(e[a][0]),Number(t[a][0])],r.iter_token=e[a][1],n.push(r)}return n}(ze(t,u),ze(t,m)),h=function(e){var t=e.map((function(e){return e.data[0]})),n=e.map((function(e){return e.data[1]})),a=Math.min.apply(null,t),r=Math.max.apply(null,t),c=Math.min.apply(null,n),i=Math.max.apply(null,n),o=r-a,u=i-c;return{min_x:a-.05*o,max_x:r+.05*o,min_y:c-.05*u,max_y:i+.05*u}}(_),E={click:function(n){return e(T(t.find((function(e){return e.iter_token===n.seriesName}))))}};return r.a.createElement("div",{className:"ChartDisplayer"},r.a.createElement("div",{className:"ChartSelector"},"Select X:",r.a.createElement("select",{value:u,onChange:function(e){return l(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select values source"),p.properties.map((function(e,t){return r.a.createElement("option",{key:"p"+String(t),value:JSON.stringify(e)},De(e))})),p.results.map((function(e,t){return r.a.createElement("option",{key:"r"+String(t),value:JSON.stringify(e)},Te(e))}))),"Select Y:",r.a.createElement("select",{value:m,onChange:function(e){return v(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select values source"),p.properties.map((function(e,t){return r.a.createElement("option",{key:"p"+String(t),value:JSON.stringify(e)},De(e))})),p.results.map((function(e,t){return r.a.createElement("option",{key:"r"+String(t),value:JSON.stringify(e)},Te(e))}))),r.a.createElement("button",{onClick:function(){return Pe("result.csv",_)}},"Download")),r.a.createElement(Ce.a,{option:Le(_,u,m,h,n),onEvents:E,style:{height:"calc(100% - 30px)",width:"100%"}}))},Ve=n(254),Ue=(n(617),function(e){var t,n={backgroundColor:"#f4f4f4",xAxis:{type:"value"},yAxis:{type:"value"},toolbox:{feature:{dataZoom:{yAxisIndex:"none",title:{zoom:"Zoom",back:"Back"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image"}}},tooltip:{trigger:"axis",axisPointer:{type:"cross",animation:!1,label:{backgroundColor:"#505765"}}},series:[]},a=Object(s.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;if(r[0].length<3)n.series.push({type:"line",showSymbol:!1,data:r});else for(var c=function(e){n.series.push({type:"line",showSymbol:!1,data:r.map((function(t){return[t[0],t[e]]}))})},i=1;i<r[0].length;i++)c(i)}}catch(o){a.e(o)}finally{a.f()}return n}),We=function(e,t){var n,a=[],r=Object(s.a)(t);try{for(r.s();!(n=r.n()).done;){var c,i=n.value,o=Object(s.a)(i);try{for(o.s();!(c=o.n()).done;){var u=c.value;a.push(u)}}catch(l){o.e(l)}finally{o.f()}}}catch(l){r.e(l)}finally{r.f()}!function(e,t){for(var n=function(e){for(var t="",n=0;n<e.length;n++){var a=null===e[n]?"":e[n].toString();e[n]instanceof Date&&(a=e[n].toLocaleString());var r=a.replace(/"/g,'""');r.search(/("|,|\n)/g)>=0&&(r='"'+r+'"'),n>0&&(t+=","),t+=r}return t+"\n"},a="",r=0;r<t.length;r++)a+=n(t[r]);var c=new Blob([a],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(c,e);else{var i=document.createElement("a");if(void 0!==i.download){var o=URL.createObjectURL(c);i.setAttribute("href",o),i.setAttribute("download",e),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}}}(e,a)},Be=function(){var e=Object(i.c)((function(e){return e.activeframes})),t=Object(a.useState)(!0),n=Object(G.a)(t,2),c=n[0],o=n[1],u=Object(a.useState)("INIT"),d=Object(G.a)(u,2),f=d[0],m=d[1],v=Object(a.useState)("INIT"),p=Object(G.a)(v,2),_=p[0],h=p[1],E=function(e){var t,n=[],a=Object(s.a)(e);try{for(a.s();!(t=a.n()).done;){var r,c=t.value,i=Object(s.a)(c.data_frames);try{for(i.s();!(r=i.n()).done;){var o=r.value.data.data_source;n.includes(o)||n.push(o)}}catch(u){i.e(u)}finally{i.f()}}}catch(u){a.e(u)}finally{a.f()}return n}(e),y=function(e,t){var n,a=[],r=Object(s.a)(t);try{for(r.s();!(n=r.n()).done;){var c,i=n.value,o=Object(s.a)(i.data_frames);try{for(o.s();!(c=o.n()).done;){var u=c.value;for(var l in u.data.results)"CSV"===u.data.results[l].type&&u.data.data_source===e&&(a.includes(l)||a.push(l))}}catch(d){o.e(d)}finally{o.f()}}}catch(d){r.e(d)}finally{r.f()}return a}(f,e),b=function(e,t,n,a){var r=[];if("INIT"!==e&&"INIT"!==t&&n.length>0)if(a){var c="";try{c=n.find((function(e){return!0===e.focussed})).data_frames.find((function(t){return t.data.data_source===e})).data.results[t].value}catch(d){c=void 0}void 0!==c&&r.push(c)}else{var i,o=Object(s.a)(n);try{for(o.s();!(i=o.n()).done;){var u=i.value,l="";try{l=u.data_frames.find((function(t){return t.data.data_source===e})).data.results[t].value}catch(f){l=void 0}void 0!==l&&r.push(l)}}catch(m){o.e(m)}finally{o.f()}}return r}(f,_,e,c),O=Object(a.useState)([]),g=Object(G.a)(O,2),I=g[0],j=g[1];return Object(a.useEffect)((function(){return function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(t.length>0){var r=t[0];t.shift(),Object(Ve.a)(""+r,{download:!0,complete:function(r){e(t,n,[].concat(Object(l.a)(a),[r.data]))}})}else a.length>0?n(a):n([])}(b,j)}),[f,_,e,c]),r.a.createElement("div",{className:"CSVDisplayer"},r.a.createElement("div",{className:"CSVSelector"},r.a.createElement("select",{value:f,onChange:function(e){return m(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select device"),E.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)}))),r.a.createElement("select",{value:_,onChange:function(e){return h(e.target.value)}},r.a.createElement("option",{value:"INIT"},"Select result to show"),y.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)}))),"Display only focussed:",r.a.createElement("input",{type:"checkbox",defaultChecked:c,onChange:function(){return o(!c)}}),r.a.createElement("button",{onClick:function(){return We("result.csv",I)}},"Download")),r.a.createElement(Ce.a,{option:Ue(I),notMerge:!0,style:{height:"calc(100% - 30px)",width:"100%"}}))},Ge=function(e){return r.a.createElement(oe,{id:e.id,z_index:e.z_index,window_name:"Application logs",default_width:400,default_height:120},r.a.createElement(fe,null))},$e=function(e){return r.a.createElement(oe,{id:e.id,z_index:e.z_index,window_name:"Selected frames",default_width:250,default_height:520},r.a.createElement(de,null))},Je=function(e){return r.a.createElement(oe,{id:e.id,z_index:e.z_index,window_name:"ROIs manager",default_width:340,default_height:320},r.a.createElement(xe,null))},He=function(e){return r.a.createElement(oe,{id:e.id,z_index:e.z_index,window_name:"Data frame atributes",default_width:600,default_height:280},r.a.createElement(pe,null))},qe=function(e){return r.a.createElement(oe,{id:e.id,z_index:e.z_index,window_name:"Image displayer",default_width:400,default_height:452,lock_aspect_ratio:!0},r.a.createElement(Ee,null))},Xe=function(e){return r.a.createElement(oe,{id:e.id,z_index:e.z_index,window_name:"ROIs",default_width:600,default_height:600,resizable:!1},r.a.createElement(je,null))},Ye=function(e){return r.a.createElement(oe,{id:e.id,z_index:e.z_index,window_name:"Chart",default_width:840,default_height:370},r.a.createElement(Fe,null))},Ze=function(e){return r.a.createElement(oe,{id:e.id,z_index:e.z_index,window_name:"CSV Chart",default_width:840,default_height:370},r.a.createElement(Be,null))},Ke=function(){var e=Object(i.c)((function(e){return e.openwindows}));return r.a.createElement("div",{className:"WorkSpace"},e.map((function(e){return function(e){var t=e.id,n=e.window_type,a=e.z_index;switch(n){case"SelectedFrames":return r.a.createElement($e,{key:t,id:t,z_index:a});case"LogList":return r.a.createElement(Ge,{key:t,id:t,z_index:a});case"AttributesList":return r.a.createElement(He,{key:t,id:t,z_index:a});case"ImageDisplayer":return r.a.createElement(qe,{key:t,id:t,z_index:a});case"ROIs":return r.a.createElement(Xe,{key:t,id:t,z_index:a});case"RoiManager":return r.a.createElement(Je,{key:t,id:t,z_index:a});case"ChartDisplayer":return r.a.createElement(Ye,{key:t,id:t,z_index:a});case"CSVDisplayer":return r.a.createElement(Ze,{key:t,id:t,z_index:a});default:console.log("Unknown window")}}(e)})))},Qe=(n(618),function(){return r.a.createElement("div",null,r.a.createElement(ce,null),r.a.createElement(Ke,null))}),et=Object(o.c)(j);Object(c.render)(r.a.createElement(i.a,{store:et},r.a.createElement(Qe,null)),document.getElementById("root"))}},[[256,1,2]]]);
//# sourceMappingURL=main.3926e4b4.chunk.js.map